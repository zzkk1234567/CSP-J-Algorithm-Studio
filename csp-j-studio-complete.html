<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ CSP-J ç®—æ³•å¯è§†åŒ–ç³»ç»Ÿ - å®Œæ•´ç‰ˆ</title>
    <link href="https://cdn.tailwindcss.com" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .algorithm-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .algorithm-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        #viz-content {
            min-height: 300px;
        }
        
        kbd {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 2px 6px;
            font-family: monospace;
            font-size: 12px;
        }

        .feature-badge {
            display: inline-block;
            background: #10b981;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            margin-left: 8px;
        }

        .feature-badge.bg-purple-500 {
            background: linear-gradient(45deg, #8b5cf6, #a855f7);
        }

        .feature-badge.bg-green-500 {
            background: linear-gradient(45deg, #10b981, #059669);
        }

        .feature-badge.bg-blue-500 {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
        }

        .version-info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="version-info">
        v2.0 å®Œæ•´ç‰ˆ | åŒ…å«æ‰€æœ‰å¢å¼ºåŠŸèƒ½
    </div>

    <div class="container mx-auto p-6">
        <!-- æ ‡é¢˜åŒº -->
        <div class="glass-effect rounded-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-4">
                ğŸ¯ CSP-J ç®—æ³•å¯è§†åŒ–ç³»ç»Ÿ - å®Œæ•´ç‰ˆ
                <span class="feature-badge">å¢å¼ºUI</span>
                <span class="feature-badge">äº’åŠ¨æ•™ç¨‹</span>
                <span class="feature-badge">æµ‹è¯•å¥—ä»¶</span>
            </h1>
            <p class="text-center text-gray-600 mb-4">
                å®Œæ•´çš„ç®—æ³•æ¼”ç¤ºã€äº¤äº’æ§åˆ¶ã€æ­¥éª¤è§£é‡Šã€å¤æ‚åº¦åˆ†æå’Œæµ‹è¯•éªŒè¯
            </p>
            <div class="text-center">
                <span class="text-sm text-gray-500">ğŸ’¡ æç¤ºï¼šä½¿ç”¨é”®ç›˜å¿«æ·é”® (ç©ºæ ¼ã€æ–¹å‘é”®) å¯ä»¥æ›´å¿«åœ°æ§åˆ¶æ¼”ç¤º</span>
            </div>
        </div>

        <!-- åŠŸèƒ½ç‰¹æ€§å±•ç¤º -->
        <div class="glass-effect rounded-lg p-4 mb-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div>
                    <div class="text-2xl mb-2">ğŸ®</div>
                    <div class="text-sm font-medium">äº¤äº’å¼å¯è§†åŒ–</div>
                </div>
                <div>
                    <div class="text-2xl mb-2">âŒ¨ï¸</div>
                    <div class="text-sm font-medium">é”®ç›˜å¿«æ·é”®</div>
                </div>
                <div>
                    <div class="text-2xl mb-2">ğŸ“š</div>
                    <div class="text-sm font-medium">äº’åŠ¨æ•™ç¨‹</div>
                </div>
                <div>
                    <div class="text-2xl mb-2">ğŸ§ª</div>
                    <div class="text-sm font-medium">è‡ªåŠ¨æµ‹è¯•</div>
                </div>
            </div>
        </div>

        <!-- ç®—æ³•é€‰æ‹©åŒº -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
            <!-- æ’åºç®—æ³• -->
            <div class="glass-effect rounded-lg p-6 algorithm-card" onclick="selectAlgorithm('sorting')">
                <h3 class="text-xl font-bold mb-4">ğŸ”„ æ’åºç®—æ³•</h3>
                <ul class="space-y-2 text-sm">
                    <li>â€¢ å†’æ³¡æ’åº (Bubble Sort)</li>
                    <li>â€¢ é€‰æ‹©æ’åº (Selection Sort)</li>
                    <li>â€¢ æ’å…¥æ’åº (Insertion Sort)</li>
                    <li>â€¢ å¿«é€Ÿæ’åº (Quick Sort)</li>
                    <li>â€¢ å½’å¹¶æ’åº (Merge Sort)</li>
                    <li>â€¢ å †æ’åº (Heap Sort) <span class="feature-badge">æ–°</span></li>
                </ul>
            </div>

            <!-- æœç´¢ç®—æ³• -->
            <div class="glass-effect rounded-lg p-6 algorithm-card" onclick="selectAlgorithm('searching')">
                <h3 class="text-xl font-bold mb-4">ğŸ” æœç´¢ç®—æ³•</h3>
                <ul class="space-y-2 text-sm">
                    <li>â€¢ çº¿æ€§æŸ¥æ‰¾ (Linear Search)</li>
                    <li>â€¢ äºŒåˆ†æŸ¥æ‰¾ (Binary Search)</li>
                    <li>â€¢ æ’å€¼æŸ¥æ‰¾ (Interpolation) <span class="feature-badge">æ–°</span></li>
                    <li>â€¢ è·³è·ƒæœç´¢ (Jump Search) <span class="feature-badge">æ–°</span></li>
                    <li>â€¢ æŒ‡æ•°æœç´¢ (Exponential) <span class="feature-badge">æ–°</span></li>
                </ul>
            </div>

            <!-- å›¾ç®—æ³• -->
            <div class="glass-effect rounded-lg p-6 algorithm-card" onclick="selectAlgorithm('graph')">
                <h3 class="text-xl font-bold mb-4">ğŸŒ å›¾ç®—æ³•</h3>
                <ul class="space-y-2 text-sm">
                    <li>â€¢ æ·±åº¦ä¼˜å…ˆæœç´¢ (DFS)</li>
                    <li>â€¢ å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS)</li>
                    <li>â€¢ Dijkstra æœ€çŸ­è·¯å¾„</li>
                    <li>â€¢ Kruskal æœ€å°ç”Ÿæˆæ ‘ <span class="feature-badge">æ–°</span></li>
                    <li>â€¢ æ‹“æ‰‘æ’åº <span class="feature-badge">æ–°</span></li>
                </ul>
            </div>

            <!-- åŠ¨æ€è§„åˆ’ -->
            <div class="glass-effect rounded-lg p-6 algorithm-card" onclick="selectAlgorithm('dp')">
                <h3 class="text-xl font-bold mb-4">ğŸ§® åŠ¨æ€è§„åˆ’</h3>
                <ul class="space-y-2 text-sm">
                    <li>â€¢ æ–æ³¢é‚£å¥‘æ•°åˆ— <span class="feature-badge">æ–°</span></li>
                    <li>â€¢ 0-1èƒŒåŒ…é—®é¢˜ <span class="feature-badge">æ–°</span></li>
                    <li>â€¢ æœ€é•¿é€’å¢å­åºåˆ— <span class="feature-badge">æ–°</span></li>
                    <li>â€¢ ç¼–è¾‘è·ç¦» <span class="feature-badge">æ–°</span></li>
                </ul>
            </div>
        </div>

        <!-- CSP-JçœŸé¢˜ç®—æ³•åŒº -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
            <!-- CSP-JçœŸé¢˜ç®—æ³• -->
            <div class="glass-effect rounded-lg p-6 algorithm-card bg-gradient-to-br from-purple-50 to-indigo-50" onclick="selectAlgorithm('cspj')">
                <h3 class="text-xl font-bold mb-4">ğŸ† CSP-JçœŸé¢˜ç®—æ³•</h3>
                <ul class="space-y-2 text-sm">
                    <li>â€¢ åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³• <span class="feature-badge bg-purple-500">çœŸé¢˜</span></li>
                    <li>â€¢ æ¬§å‡ é‡Œå¾—ç®—æ³• <span class="feature-badge bg-purple-500">çœŸé¢˜</span></li>
                    <li>â€¢ è¿›åˆ¶è½¬æ¢ <span class="feature-badge bg-purple-500">çœŸé¢˜</span></li>
                    <li>â€¢ é€’å½’é˜¶ä¹˜ <span class="feature-badge bg-purple-500">çœŸé¢˜</span></li>
                    <li>â€¢ æ–æ³¢é‚£å¥‘DP <span class="feature-badge bg-purple-500">çœŸé¢˜</span></li>
                    <li>â€¢ æ ˆæ¨¡æ‹Ÿ <span class="feature-badge bg-purple-500">çœŸé¢˜</span></li>
                    <li>â€¢ é˜Ÿåˆ—æ¨¡æ‹Ÿ <span class="feature-badge bg-purple-500">çœŸé¢˜</span></li>
                </ul>
            </div>

            <!-- æ€§èƒ½å¯¹æ¯” -->
            <div class="glass-effect rounded-lg p-6 algorithm-card bg-gradient-to-br from-green-50 to-emerald-50" onclick="selectAlgorithm('performance')">
                <h3 class="text-xl font-bold mb-4">âš¡ æ€§èƒ½å¯¹æ¯”</h3>
                <ul class="space-y-2 text-sm">
                    <li>â€¢ ç®—æ³•é€Ÿåº¦æµ‹è¯• <span class="feature-badge bg-green-500">æ–°</span></li>
                    <li>â€¢ å†…å­˜ä½¿ç”¨åˆ†æ <span class="feature-badge bg-green-500">æ–°</span></li>
                    <li>â€¢ å¤æ‚åº¦éªŒè¯ <span class="feature-badge bg-green-500">æ–°</span></li>
                    <li>â€¢ åŸºå‡†æµ‹è¯•æŠ¥å‘Š <span class="feature-badge bg-green-500">æ–°</span></li>
                </ul>
            </div>

            <!-- ç§»åŠ¨ç«¯ä¼˜åŒ– -->
            <div class="glass-effect rounded-lg p-6 algorithm-card bg-gradient-to-br from-blue-50 to-cyan-50" onclick="initMobileOptimization()">
                <h3 class="text-xl font-bold mb-4">ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–</h3>
                <ul class="space-y-2 text-sm">
                    <li>â€¢ è§¦æ§ä¼˜åŒ– <span class="feature-badge bg-blue-500">æ–°</span></li>
                    <li>â€¢ å“åº”å¼å¸ƒå±€ <span class="feature-badge bg-blue-500">æ–°</span></li>
                    <li>â€¢ æ‰‹åŠ¿æ”¯æŒ <span class="feature-badge bg-blue-500">æ–°</span></li>
                    <li>â€¢ æ€§èƒ½ä¼˜åŒ– <span class="feature-badge bg-blue-500">æ–°</span></li>
                </ul>
            </div>
        </div>

        <!-- ç®—æ³•è¯¦ç»†é€‰æ‹© -->
        <div id="algorithm-selector" class="glass-effect rounded-lg p-6 mb-6 hidden">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <label class="text-sm font-medium text-gray-700 mr-2">é€‰æ‹©ç®—æ³•ï¼š</label>
                    <select id="specific-algorithm" class="p-2 border rounded-md" onchange="initAlgorithm()">
                        <option value="">è¯·é€‰æ‹©å…·ä½“ç®—æ³•</option>
                    </select>
                </div>
                <div class="flex gap-2">
                    <button onclick="showAlgorithmInfo()" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                        ğŸ“– ç®—æ³•åŸç†
                    </button>
                    <button onclick="startTutorial()" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                        ğŸ“ äº’åŠ¨æ•™ç¨‹
                    </button>
                </div>
            </div>
        </div>

        <!-- å¯è§†åŒ–ä¸»åŒºåŸŸ -->
        <div id="visualization-container" class="hidden">
            <div class="glass-effect rounded-lg p-6">
                <h3 class="text-xl font-bold mb-4">ğŸ¯ ç®—æ³•å¯è§†åŒ–æ¼”ç¤º</h3>
                <div id="viz-content"></div>
            </div>
        </div>

        <!-- ç®—æ³•åŸç†è¯´æ˜ -->
        <div id="algorithm-info-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="glass-effect rounded-lg p-8 max-w-4xl max-h-[80vh] overflow-auto mx-auto">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold" id="algorithm-title">ç®—æ³•åŸç†</h2>
                    <button onclick="closeAlgorithmInfo()" class="text-2xl hover:text-red-500 transition-colors">âœ–ï¸</button>
                </div>
                <div id="algorithm-details"></div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥æ‰€æœ‰ç®—æ³•å¯è§†åŒ–ç³»ç»Ÿ -->
    <script src="algorithm-visualizer.js"></script>
    <script src="algorithm-visualizer-enhanced.js"></script>
    <script src="additional-algorithms.js"></script>
    <script src="enhanced-ui-improvements.js"></script>
    <script src="interactive-tutorial-system.js"></script>
    <script src="comprehensive-test-system.js"></script>
    <script src="utils/VisualizerFactory.js"></script>
    
    <script>
        // æ³¨å†Œæ‰€æœ‰å¯è§†åŒ–å™¨ç±»å‹
        VisualizerFactory.registerBatch({
            // åŸºç¡€æ’åºç®—æ³•
            'bubble': SortingVisualizer,
            'selection': SortingVisualizer,
            'insertion': SortingVisualizer,
            'quick': SortingVisualizer,
            'merge': SortingVisualizer,
            
            // å¢å¼ºæ’åºç®—æ³•
            'heap': EnhancedSortingVisualizer,
            'counting': EnhancedSortingVisualizer,
            'radix': EnhancedSortingVisualizer,
            'bucket': EnhancedSortingVisualizer,
            'shell': EnhancedSortingVisualizer,
            
            // åŸºç¡€æœç´¢ç®—æ³•
            'linear': SearchVisualizer,
            'binary': SearchVisualizer,
            
            // å¢å¼ºæœç´¢ç®—æ³•
            'interpolation': EnhancedSearchVisualizer,
            'jump': EnhancedSearchVisualizer,
            'exponential': EnhancedSearchVisualizer,
            'fibonacci': EnhancedSearchVisualizer,
            'ternary': EnhancedSearchVisualizer,
            
            // åŸºç¡€å›¾ç®—æ³•
            'dfs': GraphVisualizer,
            'bfs': GraphVisualizer,
            'dijkstra': GraphVisualizer,
            
            // å¢å¼ºå›¾ç®—æ³•
            'kruskal': EnhancedGraphVisualizer,
            'prim': EnhancedGraphVisualizer,
            'topological': EnhancedGraphVisualizer,
            'bellman-ford': EnhancedGraphVisualizer,
            'floyd-warshall': EnhancedGraphVisualizer,
            
            // åŠ¨æ€è§„åˆ’ç®—æ³•
            'dp-fibonacci': DynamicProgrammingVisualizer,
            'dp-knapsack': DynamicProgrammingVisualizer,
            'dp-lcs': DynamicProgrammingVisualizer,
            'dp-lis': DynamicProgrammingVisualizer,
            
            // è´ªå¿ƒç®—æ³•
            'greedy-activity': GreedyAlgorithmVisualizer,
            'greedy-coin': GreedyAlgorithmVisualizer,
            'greedy-huffman': GreedyAlgorithmVisualizer,
            
            // CSP-JçœŸé¢˜ç®—æ³•
            'cspj-prime-sieve': CSPJExamAlgorithmVisualizer,
            'cspj-prefix-sum': CSPJExamAlgorithmVisualizer,
            'cspj-two-pointers': CSPJExamAlgorithmVisualizer,
            
            // æ•°å­¦ç®—æ³•
            'math-gcd': MathAlgorithmVisualizer,
            'math-prime': MathAlgorithmVisualizer,
            'math-factorial': MathAlgorithmVisualizer
        });
        
        console.log('âœ… å·²æ³¨å†Œ', VisualizerFactory.getRegisteredCount(), 'ä¸ªå¯è§†åŒ–å™¨ç±»å‹');
        console.log('å¯ç”¨ç±»å‹:', VisualizerFactory.getAvailableTypes());
    </script>
    
    <script>
        let currentVisualizer = null;
        let currentCategory = '';

        // åˆå¹¶æ‰€æœ‰ç®—æ³•ä¿¡æ¯
        const algorithmInfo = {
            // åŸºç¡€ç®—æ³•ä¿¡æ¯
            'bubble': {
                name: 'å†’æ³¡æ’åº',
                principle: 'é€šè¿‡é‡å¤éå†è¦æ’åºçš„åˆ—è¡¨ï¼Œæ¯”è¾ƒç›¸é‚»å…ƒç´ å¹¶äº¤æ¢å®ƒä»¬çš„ä½ç½®ï¼ˆå¦‚æœé¡ºåºé”™è¯¯ï¼‰ï¼Œä½¿å¾—æ¯æ¬¡éå†åæœ€å¤§çš„å…ƒç´ "å†’æ³¡"åˆ°åˆ—è¡¨æœ«å°¾ã€‚',
                complexity: {
                    time: { best: 'O(n)', average: 'O(nÂ²)', worst: 'O(nÂ²)' },
                    space: 'O(1)'
                },
                advantages: ['å®ç°ç®€å•', 'ç¨³å®šæ’åº', 'åŸåœ°æ’åº'],
                disadvantages: ['æ•ˆç‡è¾ƒä½', 'ä¸é€‚åˆå¤§è§„æ¨¡æ•°æ®'],
                code: `void bubbleSort(int arr[], int n) {
    for (int i = 0; i < n-1; i++) {
        for (int j = 0; j < n-i-1; j++) {
            if (arr[j] > arr[j+1]) {
                swap(arr[j], arr[j+1]);
            }
        }
    }
}`
            },
            'selection': {
                name: 'é€‰æ‹©æ’åº',
                principle: 'åœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œç„¶åå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰å…ƒç´ ã€‚',
                complexity: {
                    time: { best: 'O(nÂ²)', average: 'O(nÂ²)', worst: 'O(nÂ²)' },
                    space: 'O(1)'
                },
                advantages: ['å®ç°ç®€å•', 'åŸåœ°æ’åº', 'äº¤æ¢æ¬¡æ•°å°‘'],
                disadvantages: ['ä¸ç¨³å®šæ’åº', 'æ•ˆç‡è¾ƒä½'],
                code: `void selectionSort(int arr[], int n) {
    for (int i = 0; i < n-1; i++) {
        int minIdx = i;
        for (int j = i+1; j < n; j++) {
            if (arr[j] < arr[minIdx]) {
                minIdx = j;
            }
        }
        swap(arr[i], arr[minIdx]);
    }
}`
            },
            'linear': {
                name: 'çº¿æ€§æŸ¥æ‰¾',
                principle: 'ä»æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œé€ä¸ªæ£€æŸ¥æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡å€¼æˆ–éå†å®Œæ•´ä¸ªæ•°ç»„ã€‚',
                complexity: {
                    time: { best: 'O(1)', average: 'O(n)', worst: 'O(n)' },
                    space: 'O(1)'
                },
                advantages: ['å®ç°ç®€å•', 'ä¸éœ€è¦æ•°ç»„æœ‰åº', 'é€‚åˆå°è§„æ¨¡æ•°æ®'],
                disadvantages: ['æ•ˆç‡ä½', 'ä¸é€‚åˆå¤§è§„æ¨¡æ•°æ®'],
                code: `int linearSearch(int arr[], int n, int target) {
    for (int i = 0; i < n; i++) {
        if (arr[i] == target) {
            return i;
        }
    }
    return -1;
}`
            },
            'binary': {
                name: 'äºŒåˆ†æŸ¥æ‰¾',
                principle: 'åœ¨æœ‰åºæ•°ç»„ä¸­ï¼Œæ¯æ¬¡æ¯”è¾ƒä¸­é—´å…ƒç´ ä¸ç›®æ ‡å€¼ï¼Œæ ¹æ®æ¯”è¾ƒç»“æœç¼©å°æœç´¢èŒƒå›´åˆ°å·¦åŠéƒ¨åˆ†æˆ–å³åŠéƒ¨åˆ†ã€‚',
                complexity: {
                    time: { best: 'O(1)', average: 'O(log n)', worst: 'O(log n)' },
                    space: 'O(1)'
                },
                advantages: ['æ•ˆç‡é«˜', 'é€‚åˆå¤§è§„æ¨¡æ•°æ®'],
                disadvantages: ['éœ€è¦æ•°ç»„æœ‰åº', 'ä¸é€‚åˆé¢‘ç¹æ’å…¥åˆ é™¤çš„åœºæ™¯'],
                code: `int binarySearch(int arr[], int n, int target) {
    int left = 0, right = n - 1;
    while (left <= right) {
        int mid = left + (right - left) / 2;
        if (arr[mid] == target) return mid;
        if (arr[mid] < target) left = mid + 1;
        else right = mid - 1;
    }
    return -1;
}`
            },
            // æ·»åŠ æ›´å¤šç®—æ³•ä¿¡æ¯
            'insertion': {
                name: 'æ’å…¥æ’åº',
                principle: 'é€šè¿‡æ„å»ºæœ‰åºåºåˆ—ï¼Œå¯¹äºæœªæ’åºæ•°æ®ï¼Œåœ¨å·²æ’åºåºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼Œæ‰¾åˆ°ç›¸åº”ä½ç½®å¹¶æ’å…¥ã€‚',
                complexity: {
                    time: { best: 'O(n)', average: 'O(nÂ²)', worst: 'O(nÂ²)' },
                    space: 'O(1)'
                },
                advantages: ['å®ç°ç®€å•', 'ç¨³å®šæ’åº', 'é€‚åˆå°è§„æ¨¡æ•°æ®'],
                disadvantages: ['æ•ˆç‡è¾ƒä½', 'ä¸é€‚åˆå¤§è§„æ¨¡æ•°æ®'],
                code: `void insertionSort(int arr[], int n) {
    for (int i = 1; i < n; i++) {
        int key = arr[i];
        int j = i - 1;
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j--;
        }
        arr[j + 1] = key;
    }
}`
            },
            'quick': {
                name: 'å¿«é€Ÿæ’åº',
                principle: 'é‡‡ç”¨åˆ†æ²»æ³•ï¼Œé€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ã€‚',
                complexity: {
                    time: { best: 'O(n log n)', average: 'O(n log n)', worst: 'O(nÂ²)' },
                    space: 'O(log n)'
                },
                advantages: ['å¹³å‡æ•ˆç‡é«˜', 'åŸåœ°æ’åº'],
                disadvantages: ['æœ€åæƒ…å†µè¾ƒå·®', 'ä¸ç¨³å®šæ’åº'],
                code: `void quickSort(int arr[], int low, int high) {
    if (low < high) {
        int pi = partition(arr, low, high);
        quickSort(arr, low, pi - 1);
        quickSort(arr, pi + 1, high);
    }
}`
            },
            'merge': {
                name: 'å½’å¹¶æ’åº',
                principle: 'é‡‡ç”¨åˆ†æ²»æ³•ï¼Œå°†æ•°ç»„åˆ†æˆä¸¤åŠï¼Œåˆ†åˆ«æ’åºï¼Œç„¶ååˆå¹¶ã€‚',
                complexity: {
                    time: { best: 'O(n log n)', average: 'O(n log n)', worst: 'O(n log n)' },
                    space: 'O(n)'
                },
                advantages: ['æ—¶é—´å¤æ‚åº¦ç¨³å®š', 'ç¨³å®šæ’åº'],
                disadvantages: ['éœ€è¦é¢å¤–ç©ºé—´'],
                code: `void mergeSort(int arr[], int l, int r) {
    if (l < r) {
        int m = l + (r - l) / 2;
        mergeSort(arr, l, m);
        mergeSort(arr, m + 1, r);
        merge(arr, l, m, r);
    }
}`
            },
            'heap': {
                name: 'å †æ’åº',
                principle: 'åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„è®¾è®¡çš„æ’åºç®—æ³•ã€‚',
                complexity: {
                    time: { best: 'O(n log n)', average: 'O(n log n)', worst: 'O(n log n)' },
                    space: 'O(1)'
                },
                advantages: ['æ—¶é—´å¤æ‚åº¦ç¨³å®š', 'åŸåœ°æ’åº'],
                disadvantages: ['ä¸ç¨³å®šæ’åº'],
                code: `void heapSort(int arr[], int n) {
    for (int i = n / 2 - 1; i >= 0; i--)
        heapify(arr, n, i);
    for (int i = n - 1; i >= 0; i--) {
        swap(arr[0], arr[i]);
        heapify(arr, i, 0);
    }
}`
            },
            // CSP-JçœŸé¢˜ç®—æ³•ä¿¡æ¯
            'prime-sieve': {
                name: 'åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•',
                principle: 'CSP-Jç»å…¸é¢˜ç›®ã€‚é€šè¿‡æ ‡è®°åˆæ•°çš„æ–¹å¼ç­›é€‰è´¨æ•°ï¼Œä»2å¼€å§‹ï¼Œå°†æ¯ä¸ªè´¨æ•°çš„å€æ•°æ ‡è®°ä¸ºåˆæ•°ã€‚',
                complexity: {
                    time: { best: 'O(n log log n)', average: 'O(n log log n)', worst: 'O(n log log n)' },
                    space: 'O(n)'
                },
                advantages: ['æ•ˆç‡é«˜', 'CSP-Jå¿…è€ƒ'],
                disadvantages: ['ç©ºé—´å ç”¨è¾ƒå¤§'],
                code: `vector<bool> sieve(int n) {
    vector<bool> isPrime(n + 1, true);
    isPrime[0] = isPrime[1] = false;
    for (int i = 2; i * i <= n; i++) {
        if (isPrime[i]) {
            for (int j = i * i; j <= n; j += i) {
                isPrime[j] = false;
            }
        }
    }
    return isPrime;
}`
            },
            'gcd-euclidean': {
                name: 'æ¬§å‡ é‡Œå¾—ç®—æ³•',
                principle: 'CSP-Jå¿…è€ƒç®—æ³•ã€‚æ±‚ä¸¤æ•°æœ€å¤§å…¬çº¦æ•°ã€‚',
                complexity: {
                    time: { best: 'O(log min(a,b))', average: 'O(log min(a,b))', worst: 'O(log min(a,b))' },
                    space: 'O(1)'
                },
                advantages: ['æ•ˆç‡æé«˜', 'CSP-Jé‡ç‚¹'],
                disadvantages: ['éœ€è¦æ•°å­¦åŸºç¡€'],
                code: `int gcd(int a, int b) {
    while (b != 0) {
        int temp = b;
        b = a % b;
        a = temp;
    }
    return a;
}`
            },
            'binary-conversion': {
                name: 'è¿›åˆ¶è½¬æ¢',
                principle: 'CSP-JåŸºç¡€é¢˜ç›®ã€‚è¿›åˆ¶é—´è½¬æ¢ã€‚',
                complexity: {
                    time: { best: 'O(log n)', average: 'O(log n)', worst: 'O(log n)' },
                    space: 'O(log n)'
                },
                advantages: ['åŸºç¡€é‡è¦', 'CSP-Jå¸¸è€ƒ'],
                disadvantages: ['éœ€è¦ç†è§£è¿›åˆ¶'],
                code: `string toBinary(int n) {
    string result = "";
    while (n > 0) {
        result = (char)('0' + n % 2) + result;
        n /= 2;
    }
    return result;
}`
            },
            'factorial-recursive': {
                name: 'é€’å½’é˜¶ä¹˜',
                principle: 'CSP-Jé€’å½’å…¥é—¨é¢˜ç›®ã€‚',
                complexity: {
                    time: { best: 'O(n)', average: 'O(n)', worst: 'O(n)' },
                    space: 'O(n)'
                },
                advantages: ['é€’å½’ç»å…¸', 'CSP-Jå¿…å­¦'],
                disadvantages: ['æ ˆæ·±åº¦é™åˆ¶'],
                code: `long long factorial(int n) {
    if (n <= 1) return 1;
    return n * factorial(n - 1);
}`
            },
            'fibonacci-dp': {
                name: 'æ–æ³¢é‚£å¥‘DP',
                principle: 'CSP-JåŠ¨æ€è§„åˆ’å…¥é—¨ã€‚',
                complexity: {
                    time: { best: 'O(n)', average: 'O(n)', worst: 'O(n)' },
                    space: 'O(n)'
                },
                advantages: ['DPå…¥é—¨', 'CSP-Jé‡ç‚¹'],
                disadvantages: ['éœ€è¦é¢å¤–ç©ºé—´'],
                code: `int fibonacciDP(int n) {
    if (n <= 1) return n;
    vector<int> dp(n + 1);
    dp[0] = 0; dp[1] = 1;
    for (int i = 2; i <= n; i++) {
        dp[i] = dp[i-1] + dp[i-2];
    }
    return dp[n];
}`
            },
            'stack-simulation': {
                name: 'æ ˆæ“ä½œæ¨¡æ‹Ÿ',
                principle: 'CSP-Jæ•°æ®ç»“æ„åŸºç¡€ã€‚',
                complexity: {
                    time: { best: 'O(1)', average: 'O(1)', worst: 'O(1)' },
                    space: 'O(n)'
                },
                advantages: ['æ•°æ®ç»“æ„åŸºç¡€', 'CSP-Jå¿…è€ƒ'],
                disadvantages: ['éœ€è¦ç†è§£LIFO'],
                code: `class Stack {
public:
    vector<int> data;
    void push(int x) { data.push_back(x); }
    int pop() {
        int x = data.back();
        data.pop_back();
        return x;
    }
};`
            },
            'queue-simulation': {
                name: 'é˜Ÿåˆ—æ“ä½œæ¨¡æ‹Ÿ',
                principle: 'CSP-Jæ•°æ®ç»“æ„åŸºç¡€ã€‚',
                complexity: {
                    time: { best: 'O(1)', average: 'O(1)', worst: 'O(1)' },
                    space: 'O(n)'
                },
                advantages: ['æ•°æ®ç»“æ„åŸºç¡€', 'CSP-Jå¸¸è€ƒ'],
                disadvantages: ['éœ€è¦ç†è§£FIFO'],
                code: `class Queue {
public:
    vector<int> data;
    int front = 0;
    void push(int x) { data.push_back(x); }
    int pop() { return data[front++]; }
};`
            }
        };

        // æ‰©å±•ç®—æ³•åˆ†ç±»
        const algorithmCategories = {
            'sorting': {
                name: 'æ’åºç®—æ³•',
                algorithms: [
                    { value: 'bubble', text: 'å†’æ³¡æ’åº' },
                    { value: 'selection', text: 'é€‰æ‹©æ’åº' },
                    { value: 'insertion', text: 'æ’å…¥æ’åº' },
                    { value: 'quick', text: 'å¿«é€Ÿæ’åº' },
                    { value: 'merge', text: 'å½’å¹¶æ’åº' },
                    { value: 'heap', text: 'å †æ’åº' }
                ]
            },
            'searching': {
                name: 'æœç´¢ç®—æ³•',
                algorithms: [
                    { value: 'linear', text: 'çº¿æ€§æŸ¥æ‰¾' },
                    { value: 'binary', text: 'äºŒåˆ†æŸ¥æ‰¾' },
                    { value: 'interpolation', text: 'æ’å€¼æŸ¥æ‰¾' },
                    { value: 'jump', text: 'è·³è·ƒæœç´¢' },
                    { value: 'exponential', text: 'æŒ‡æ•°æœç´¢' }
                ]
            },
            'graph': {
                name: 'å›¾ç®—æ³•',
                algorithms: [
                    { value: 'dfs', text: 'æ·±åº¦ä¼˜å…ˆæœç´¢' },
                    { value: 'bfs', text: 'å¹¿åº¦ä¼˜å…ˆæœç´¢' },
                    { value: 'dijkstra', text: 'Dijkstraæœ€çŸ­è·¯å¾„' },
                    { value: 'kruskal', text: 'Kruskalæœ€å°ç”Ÿæˆæ ‘' },
                    { value: 'topological', text: 'æ‹“æ‰‘æ’åº' }
                ]
            },
            'dp': {
                name: 'åŠ¨æ€è§„åˆ’',
                algorithms: [
                    { value: 'fibonacci', text: 'æ–æ³¢é‚£å¥‘æ•°åˆ—' },
                    { value: 'knapsack', text: '0-1èƒŒåŒ…é—®é¢˜' },
                    { value: 'lis', text: 'æœ€é•¿é€’å¢å­åºåˆ—' }
                ]
            },
            'cspj': {
                name: 'CSP-JçœŸé¢˜ç®—æ³•',
                algorithms: [
                    { value: 'prime-sieve', text: 'åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•' },
                    { value: 'gcd-euclidean', text: 'æ¬§å‡ é‡Œå¾—ç®—æ³•' },
                    { value: 'binary-conversion', text: 'è¿›åˆ¶è½¬æ¢' },
                    { value: 'factorial-recursive', text: 'é€’å½’é˜¶ä¹˜' },
                    { value: 'fibonacci-dp', text: 'æ–æ³¢é‚£å¥‘DP' },
                    { value: 'stack-simulation', text: 'æ ˆæ“ä½œæ¨¡æ‹Ÿ' },
                    { value: 'queue-simulation', text: 'é˜Ÿåˆ—æ“ä½œæ¨¡æ‹Ÿ' }
                ]
            },
            'performance': {
                name: 'ç®—æ³•æ€§èƒ½å¯¹æ¯”',
                algorithms: [
                    { value: 'sort-comparison', text: 'æ’åºç®—æ³•å¯¹æ¯”' },
                    { value: 'search-comparison', text: 'æœç´¢ç®—æ³•å¯¹æ¯”' },
                    { value: 'complexity-analysis', text: 'å¤æ‚åº¦åˆ†æ' },
                    { value: 'benchmark-test', text: 'åŸºå‡†æµ‹è¯•' }
                ]
            }
        };

        // é€‰æ‹©ç®—æ³•ç±»åˆ«
        function selectAlgorithm(category) {
            currentCategory = category;
            const selector = document.getElementById('algorithm-selector');
            const select = document.getElementById('specific-algorithm');
            
            // æ¸…ç©ºé€‰æ‹©æ¡†
            select.innerHTML = '<option value="">è¯·é€‰æ‹©å…·ä½“ç®—æ³•</option>';
            
            // æ·»åŠ è¯¥ç±»åˆ«çš„ç®—æ³•
            const algorithms = algorithmCategories[category].algorithms;
            algorithms.forEach(algo => {
                const option = document.createElement('option');
                option.value = algo.value;
                option.textContent = algo.text;
                select.appendChild(option);
            });
            
            selector.classList.remove('hidden');
            document.getElementById('visualization-container').classList.add('hidden');
        }

        // åˆå§‹åŒ–ç®—æ³•
        function initAlgorithm() {
            const algorithm = document.getElementById('specific-algorithm').value;
            if (!algorithm) return;
            
            const container = document.getElementById('visualization-container');
            container.classList.remove('hidden');
            
            // æ¸…ç†ä¹‹å‰çš„å¯è§†åŒ–
            if (currentVisualizer) {
                currentVisualizer = null;
            }
            
            // æ ¹æ®ç±»åˆ«åˆ›å»ºç›¸åº”çš„å¯è§†åŒ–å™¨
            if (currentCategory === 'sorting') {
                const VisualizerClass = window.EnhancedSortingVisualizer || SortingVisualizer;
                currentVisualizer = new VisualizerClass('visualization-container', algorithm);
                currentVisualizer.setData([64, 34, 25, 12, 22, 11, 90, 88, 55, 42]);
            } else if (currentCategory === 'searching') {
                const VisualizerClass = window.EnhancedSearchVisualizer || SearchVisualizer;
                currentVisualizer = new VisualizerClass('visualization-container', algorithm);
                currentVisualizer.setData([3, 7, 14, 19, 25, 31, 38, 42, 55, 67, 73, 89, 95]);
                currentVisualizer.setTarget(42);
            } else if (currentCategory === 'graph') {
                const VisualizerClass = window.EnhancedGraphVisualizer || GraphVisualizer;
                currentVisualizer = new VisualizerClass('visualization-container', algorithm);
                const nodes = [
                    { id: 'A', label: 'A', x: 100, y: 100 },
                    { id: 'B', label: 'B', x: 200, y: 100 },
                    { id: 'C', label: 'C', x: 300, y: 100 },
                    { id: 'D', label: 'D', x: 150, y: 200 },
                    { id: 'E', label: 'E', x: 250, y: 200 }
                ];
                const edges = [
                    { from: 'A', to: 'B', directed: false },
                    { from: 'B', to: 'C', directed: false },
                    { from: 'A', to: 'D', directed: false },
                    { from: 'B', to: 'E', directed: false },
                    { from: 'D', to: 'E', directed: false },
                    { from: 'C', to: 'E', directed: false }
                ];
                currentVisualizer.setGraph(nodes, edges);
            } else if (currentCategory === 'dp') {
                const VisualizerClass = window.DynamicProgrammingVisualizer;
                if (VisualizerClass) {
                    currentVisualizer = new VisualizerClass('visualization-container', algorithm);
                }
            } else if (currentCategory === 'cspj') {
                // CSP-JçœŸé¢˜ç®—æ³•
                const VisualizerClass = window.CSPJExamAlgorithmVisualizer;
                if (VisualizerClass) {
                    currentVisualizer = new VisualizerClass('viz-content', algorithm);
                }
            } else if (currentCategory === 'performance') {
                // ç®—æ³•æ€§èƒ½å¯¹æ¯”
                const ComparisonClass = window.AlgorithmPerformanceComparison;
                if (ComparisonClass) {
                    currentVisualizer = new ComparisonClass('viz-content', algorithm);
                }
            }
            
            if (currentVisualizer) {
                currentVisualizer.init();
                if (currentVisualizer.initVisualization) {
                    currentVisualizer.initVisualization();
                }
                window.visualizer = currentVisualizer;
            }
        }

        // æ˜¾ç¤ºç®—æ³•åŸç†
        function showAlgorithmInfo() {
            const algorithm = document.getElementById('specific-algorithm').value;
            console.log('ç‚¹å‡»äº†ç®—æ³•åŸç†æŒ‰é’®ï¼Œå½“å‰é€‰ä¸­ç®—æ³•:', algorithm);
            
            if (!algorithm) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç®—æ³•ï¼');
                return;
            }
            
            // åˆå¹¶åŸºç¡€ä¿¡æ¯å’Œæ‰©å±•ä¿¡æ¯
            const allInfo = { ...algorithmInfo, ...(window.additionalAlgorithmInfo || {}) };
            const info = allInfo[algorithm];
            
            console.log('æŸ¥æ‰¾ç®—æ³•ä¿¡æ¯:', algorithm, info);
            console.log('å¯ç”¨çš„ç®—æ³•ä¿¡æ¯é”®:', Object.keys(allInfo));
            
            if (!info) {
                alert(`æ‰¾ä¸åˆ°ç®—æ³• "${algorithm}" çš„ä¿¡æ¯ï¼å¯ç”¨ç®—æ³•: ${Object.keys(allInfo).join(', ')}`);
                return;
            }
            
            const modal = document.getElementById('algorithm-info-modal');
            const title = document.getElementById('algorithm-title');
            const details = document.getElementById('algorithm-details');
            
            if (!modal || !title || !details) {
                console.error('æ‰¾ä¸åˆ°å¿…è¦çš„DOMå…ƒç´ :', { modal: !!modal, title: !!title, details: !!details });
                return;
            }
            
            title.textContent = info.name;
            details.innerHTML = `
                <div class="space-y-4">
                    <!-- ç®—æ³•åŠ¨ç”»æ¼”ç¤ºåŒºåŸŸ -->
                    <div>
                        <h3 class="font-bold text-lg mb-2">ğŸ¥ ç®—æ³•åŠ¨ç”»æ¼”ç¤º</h3>
                        <div id="algorithm-animation-container" class="bg-gray-50 p-4 rounded-lg border-2 border-dashed border-gray-300 min-h-[200px] flex items-center justify-center">
                            <div class="text-center">
                                <button onclick="startAlgorithmDemo('${algorithm}')" class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    ğŸš€ å¼€å§‹æ¼”ç¤º
                                </button>
                                <p class="text-sm text-gray-600 mt-2">ç‚¹å‡»å¼€å§‹ç®—æ³•åŠ¨ç”»æ¼”ç¤º</p>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-bold text-lg mb-2">ğŸ“– åŸºæœ¬åŸç†</h3>
                        <p class="text-gray-700">${info.principle}</p>
                    </div>
                    
                    <div>
                        <h3 class="font-bold text-lg mb-2">â±ï¸ æ—¶é—´å¤æ‚åº¦</h3>
                        <div class="grid grid-cols-3 gap-4">
                            <div class="bg-green-100 p-3 rounded">
                                <p class="text-sm text-green-700">æœ€ä½³æƒ…å†µ</p>
                                <p class="font-mono font-bold">${info.complexity.time.best}</p>
                            </div>
                            <div class="bg-yellow-100 p-3 rounded">
                                <p class="text-sm text-yellow-700">å¹³å‡æƒ…å†µ</p>
                                <p class="font-mono font-bold">${info.complexity.time.average}</p>
                            </div>
                            <div class="bg-red-100 p-3 rounded">
                                <p class="text-sm text-red-700">æœ€åæƒ…å†µ</p>
                                <p class="font-mono font-bold">${info.complexity.time.worst}</p>
                            </div>
                        </div>
                        <p class="mt-2"><strong>ç©ºé—´å¤æ‚åº¦ï¼š</strong><span class="font-mono">${info.complexity.space}</span></p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h3 class="font-bold text-lg mb-2">âœ… ä¼˜ç‚¹</h3>
                            <ul class="list-disc pl-5 space-y-1">
                                ${info.advantages.map(adv => `<li class="text-green-700">${adv}</li>`).join('')}
                            </ul>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg mb-2">âŒ ç¼ºç‚¹</h3>
                            <ul class="list-disc pl-5 space-y-1">
                                ${info.disadvantages.map(dis => `<li class="text-red-700">${dis}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-bold text-lg mb-2">ğŸ’» C++ä»£ç å®ç°</h3>
                        <pre class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto"><code>${info.code}</code></pre>
                    </div>
                </div>
            `;
            
            console.log('æ˜¾ç¤ºæ¨¡æ€æ¡†');
            modal.classList.remove('hidden');
        }

        // å…³é—­ç®—æ³•åŸç†å¼¹çª—
        function closeAlgorithmInfo() {
            document.getElementById('algorithm-info-modal').classList.add('hidden');
        }

        // å¯åŠ¨ç®—æ³•åŠ¨ç”»æ¼”ç¤º
        function startAlgorithmDemo(algorithm) {
            console.log('å¼€å§‹ç®—æ³•åŠ¨ç”»æ¼”ç¤º:', algorithm);
            
            const container = document.getElementById('algorithm-animation-container');
            if (!container) return;
            
            // æ ¹æ®ç®—æ³•ç±»å‹åˆ›å»ºä¸åŒçš„æ¼”ç¤º
            switch(algorithm) {
                case 'bubble':
                    bubbleSortDemo(container);
                    break;
                case 'selection':
                    selectionSortDemo(container);
                    break;
                case 'insertion':
                    insertionSortDemo(container);
                    break;
                case 'quick':
                    quickSortDemo(container);
                    break;
                case 'merge':
                    mergeSortDemo(container);
                    break;
                case 'heap':
                    heapSortDemo(container);
                    break;
                case 'linear':
                    linearSearchDemo(container);
                    break;
                case 'binary':
                    binarySearchDemo(container);
                    break;
                case 'prime-sieve':
                    primeSieveDemo(container);
                    break;
                case 'gcd-euclidean':
                    gcdDemo(container);
                    break;
                case 'binary-conversion':
                    binaryConversionDemo(container);
                    break;
                case 'factorial-recursive':
                    factorialDemo(container);
                    break;
                case 'fibonacci-dp':
                    fibonacciDemo(container);
                    break;
                case 'stack-simulation':
                    stackDemo(container);
                    break;
                case 'queue-simulation':
                    queueDemo(container);
                    break;
                default:
                    defaultDemo(container, algorithm);
            }
        }

        // å†’æ³¡æ’åºæ¼”ç¤º
        function bubbleSortDemo(container) {
            const data = [64, 34, 25, 12, 22, 11, 90];
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">å†’æ³¡æ’åºæ¼”ç¤º</h4>
                    <div id="bubble-array" class="flex justify-center gap-2 mb-4"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="bubbleSortStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="bubbleSortReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="bubble-status" class="mt-2 text-sm text-gray-600">å‡†å¤‡å°±ç»ª...</p>
                </div>
            `;
            
            window.bubbleData = [...data];
            window.bubbleStep = 0;
            window.bubbleI = 0;
            window.bubbleJ = 0;
            
            renderBubbleArray();
        }

        function renderBubbleArray() {
            const arrayDiv = document.getElementById('bubble-array');
            if (!arrayDiv || !window.bubbleData) return;
            
            arrayDiv.innerHTML = window.bubbleData.map((value, index) => {
                let bgColor = 'bg-blue-100';
                if (index === window.bubbleJ || index === window.bubbleJ + 1) {
                    bgColor = 'bg-yellow-200';
                }
                return `<div class="${bgColor} border-2 border-blue-300 p-2 min-w-[40px] text-center font-bold">${value}</div>`;
            }).join('');
        }

        function bubbleSortStep() {
            if (!window.bubbleData) return;
            
            const n = window.bubbleData.length;
            const statusDiv = document.getElementById('bubble-status');
            
            if (window.bubbleI >= n - 1) {
                statusDiv.textContent = 'æ’åºå®Œæˆï¼';
                return;
            }
            
            if (window.bubbleJ >= n - window.bubbleI - 1) {
                window.bubbleI++;
                window.bubbleJ = 0;
                statusDiv.textContent = `ç¬¬ ${window.bubbleI} è½®å¼€å§‹`;
            } else {
                if (window.bubbleData[window.bubbleJ] > window.bubbleData[window.bubbleJ + 1]) {
                    // äº¤æ¢
                    [window.bubbleData[window.bubbleJ], window.bubbleData[window.bubbleJ + 1]] = 
                    [window.bubbleData[window.bubbleJ + 1], window.bubbleData[window.bubbleJ]];
                    statusDiv.textContent = `äº¤æ¢ ${window.bubbleData[window.bubbleJ + 1]} å’Œ ${window.bubbleData[window.bubbleJ]}`;
                } else {
                    statusDiv.textContent = `æ¯”è¾ƒ ${window.bubbleData[window.bubbleJ]} å’Œ ${window.bubbleData[window.bubbleJ + 1]}, ä¸éœ€äº¤æ¢`;
                }
                window.bubbleJ++;
            }
            
            renderBubbleArray();
        }

        function bubbleSortReset() {
            bubbleSortDemo(document.getElementById('algorithm-animation-container'));
        }

        // é€‰æ‹©æ’åºæ¼”ç¤º
        function selectionSortDemo(container) {
            const data = [64, 34, 25, 12, 22, 11, 90];
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">é€‰æ‹©æ’åºæ¼”ç¤º</h4>
                    <div id="selection-array" class="flex justify-center gap-2 mb-4"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="selectionSortStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="selectionSortReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="selection-status" class="mt-2 text-sm text-gray-600">å‡†å¤‡å°±ç»ª...</p>
                </div>
            `;
            
            window.selectionData = [...data];
            window.selectionI = 0;
            window.selectionJ = 0;
            window.selectionMinIdx = 0;
            window.selectionPhase = 'finding'; // 'finding' or 'swapping'
            
            renderSelectionArray();
        }

        function renderSelectionArray() {
            const arrayDiv = document.getElementById('selection-array');
            if (!arrayDiv || !window.selectionData) return;
            
            arrayDiv.innerHTML = window.selectionData.map((value, index) => {
                let bgColor = 'bg-blue-100';
                if (index < window.selectionI) {
                    bgColor = 'bg-green-200'; // å·²æ’åº
                } else if (index === window.selectionMinIdx) {
                    bgColor = 'bg-yellow-200'; // å½“å‰æœ€å°å€¼
                } else if (index === window.selectionJ && window.selectionPhase === 'finding') {
                    bgColor = 'bg-orange-200'; // å½“å‰æ¯”è¾ƒ
                }
                return `<div class="${bgColor} border-2 border-blue-300 p-2 min-w-[40px] text-center font-bold">${value}</div>`;
            }).join('');
        }

        function selectionSortStep() {
            if (!window.selectionData) return;
            
            const n = window.selectionData.length;
            const statusDiv = document.getElementById('selection-status');
            
            if (window.selectionI >= n - 1) {
                statusDiv.textContent = 'æ’åºå®Œæˆï¼';
                return;
            }
            
            if (window.selectionPhase === 'finding') {
                if (window.selectionJ === window.selectionI) {
                    window.selectionMinIdx = window.selectionI;
                    window.selectionJ++;
                    statusDiv.textContent = `ç¬¬ ${window.selectionI + 1} è½®ï¼šå¯»æ‰¾æœ€å°å€¼ï¼Œå½“å‰æœ€å°å€¼ä½ç½®: ${window.selectionMinIdx}`;
                } else if (window.selectionJ < n) {
                    if (window.selectionData[window.selectionJ] < window.selectionData[window.selectionMinIdx]) {
                        window.selectionMinIdx = window.selectionJ;
                        statusDiv.textContent = `æ‰¾åˆ°æ›´å°å€¼ ${window.selectionData[window.selectionJ]}ï¼Œæ›´æ–°æœ€å°å€¼ä½ç½®: ${window.selectionMinIdx}`;
                    } else {
                        statusDiv.textContent = `æ¯”è¾ƒ ${window.selectionData[window.selectionJ]} >= ${window.selectionData[window.selectionMinIdx]}ï¼Œä¿æŒæœ€å°å€¼ä½ç½®: ${window.selectionMinIdx}`;
                    }
                    window.selectionJ++;
                } else {
                    window.selectionPhase = 'swapping';
                    statusDiv.textContent = `æ‰¾åˆ°æœ€å°å€¼ ${window.selectionData[window.selectionMinIdx]}ï¼Œå‡†å¤‡äº¤æ¢`;
                }
            } else if (window.selectionPhase === 'swapping') {
                if (window.selectionMinIdx !== window.selectionI) {
                    [window.selectionData[window.selectionI], window.selectionData[window.selectionMinIdx]] = 
                    [window.selectionData[window.selectionMinIdx], window.selectionData[window.selectionI]];
                    statusDiv.textContent = `äº¤æ¢ä½ç½® ${window.selectionI} å’Œ ${window.selectionMinIdx}`;
                } else {
                    statusDiv.textContent = `æœ€å°å€¼å·²åœ¨æ­£ç¡®ä½ç½®ï¼Œæ— éœ€äº¤æ¢`;
                }
                window.selectionI++;
                window.selectionJ = window.selectionI;
                window.selectionPhase = 'finding';
            }
            
            renderSelectionArray();
        }

        function selectionSortReset() {
            selectionSortDemo(document.getElementById('algorithm-animation-container'));
        }

        // æ’å…¥æ’åºæ¼”ç¤º
        function insertionSortDemo(container) {
            const data = [64, 34, 25, 12, 22, 11, 90];
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">æ’å…¥æ’åºæ¼”ç¤º</h4>
                    <div id="insertion-array" class="flex justify-center gap-2 mb-4"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="insertionSortStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="insertionSortReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="insertion-status" class="mt-2 text-sm text-gray-600">å‡†å¤‡å°±ç»ª...</p>
                </div>
            `;
            
            window.insertionData = [...data];
            window.insertionI = 1;
            window.insertionJ = 0;
            window.insertionKey = data[1];
            window.insertionPhase = 'select'; // 'select', 'compare', 'shift', 'insert'
            
            renderInsertionArray();
        }

        function renderInsertionArray() {
            const arrayDiv = document.getElementById('insertion-array');
            if (!arrayDiv || !window.insertionData) return;
            
            arrayDiv.innerHTML = window.insertionData.map((value, index) => {
                let bgColor = 'bg-blue-100';
                if (index < window.insertionI) {
                    bgColor = 'bg-green-200'; // å·²æ’åºåŒºåŸŸ
                } else if (index === window.insertionI && window.insertionPhase === 'select') {
                    bgColor = 'bg-yellow-200'; // å½“å‰é€‰æ‹©çš„å…ƒç´ 
                } else if (index === window.insertionJ && window.insertionPhase === 'compare') {
                    bgColor = 'bg-orange-200'; // å½“å‰æ¯”è¾ƒä½ç½®
                }
                return `<div class="${bgColor} border-2 border-blue-300 p-2 min-w-[40px] text-center font-bold">${value}</div>`;
            }).join('');
        }

        function insertionSortStep() {
            if (!window.insertionData) return;
            
            const n = window.insertionData.length;
            const statusDiv = document.getElementById('insertion-status');
            
            if (window.insertionI >= n) {
                statusDiv.textContent = 'æ’åºå®Œæˆï¼';
                return;
            }
            
            if (window.insertionPhase === 'select') {
                window.insertionKey = window.insertionData[window.insertionI];
                window.insertionJ = window.insertionI - 1;
                window.insertionPhase = 'compare';
                statusDiv.textContent = `é€‰æ‹©å…ƒç´  ${window.insertionKey}ï¼Œå‡†å¤‡æ’å…¥åˆ°å·²æ’åºåŒºåŸŸ`;
            } else if (window.insertionPhase === 'compare') {
                if (window.insertionJ >= 0 && window.insertionData[window.insertionJ] > window.insertionKey) {
                    window.insertionPhase = 'shift';
                    statusDiv.textContent = `${window.insertionData[window.insertionJ]} > ${window.insertionKey}ï¼Œéœ€è¦å³ç§»`;
                } else {
                    window.insertionPhase = 'insert';
                    statusDiv.textContent = `æ‰¾åˆ°æ’å…¥ä½ç½®: ${window.insertionJ + 1}`;
                }
            } else if (window.insertionPhase === 'shift') {
                window.insertionData[window.insertionJ + 1] = window.insertionData[window.insertionJ];
                window.insertionJ--;
                window.insertionPhase = 'compare';
                statusDiv.textContent = `å…ƒç´ å³ç§»ï¼Œç»§ç»­å‘å·¦æ¯”è¾ƒ`;
            } else if (window.insertionPhase === 'insert') {
                window.insertionData[window.insertionJ + 1] = window.insertionKey;
                window.insertionI++;
                window.insertionPhase = 'select';
                statusDiv.textContent = `æ’å…¥å®Œæˆï¼Œå¤„ç†ä¸‹ä¸€ä¸ªå…ƒç´ `;
            }
            
            renderInsertionArray();
        }

        function insertionSortReset() {
            insertionSortDemo(document.getElementById('algorithm-animation-container'));
        }

        // äºŒåˆ†æŸ¥æ‰¾æ¼”ç¤º
        function binarySearchDemo(container) {
            const data = [3, 7, 14, 19, 25, 31, 38, 42, 55, 66];
            const target = 25;
            
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">äºŒåˆ†æŸ¥æ‰¾æ¼”ç¤º (æŸ¥æ‰¾: ${target})</h4>
                    <div id="binary-array" class="flex justify-center gap-2 mb-4"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="binarySearchStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="binarySearchReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="binary-status" class="mt-2 text-sm text-gray-600">å¼€å§‹äºŒåˆ†æŸ¥æ‰¾...</p>
                </div>
            `;
            
            window.binaryData = [...data];
            window.binaryTarget = target;
            window.binaryLeft = 0;
            window.binaryRight = data.length - 1;
            window.binaryMid = Math.floor((0 + data.length - 1) / 2);
            window.binaryFound = false;
            
            renderBinaryArray();
        }

        function renderBinaryArray() {
            const arrayDiv = document.getElementById('binary-array');
            if (!arrayDiv || !window.binaryData) return;
            
            arrayDiv.innerHTML = window.binaryData.map((value, index) => {
                let bgColor = 'bg-blue-100';
                if (window.binaryFound && value === window.binaryTarget) {
                    bgColor = 'bg-green-200';
                } else if (index === window.binaryMid) {
                    bgColor = 'bg-yellow-200';
                } else if (index >= window.binaryLeft && index <= window.binaryRight) {
                    bgColor = 'bg-blue-200';
                } else {
                    bgColor = 'bg-gray-200';
                }
                return `<div class="${bgColor} border-2 border-blue-300 p-2 min-w-[40px] text-center font-bold">${value}</div>`;
            }).join('');
        }

        function binarySearchStep() {
            if (!window.binaryData || window.binaryFound) return;
            
            const statusDiv = document.getElementById('binary-status');
            
            if (window.binaryLeft > window.binaryRight) {
                statusDiv.textContent = 'æœªæ‰¾åˆ°ç›®æ ‡å€¼';
                return;
            }
            
            window.binaryMid = Math.floor((window.binaryLeft + window.binaryRight) / 2);
            
            if (window.binaryData[window.binaryMid] === window.binaryTarget) {
                window.binaryFound = true;
                statusDiv.textContent = `æ‰¾åˆ°ç›®æ ‡å€¼ ${window.binaryTarget} åœ¨ä½ç½® ${window.binaryMid}`;
            } else if (window.binaryData[window.binaryMid] < window.binaryTarget) {
                window.binaryLeft = window.binaryMid + 1;
                statusDiv.textContent = `${window.binaryData[window.binaryMid]} < ${window.binaryTarget}ï¼Œæœç´¢å³åŠéƒ¨åˆ†`;
            } else {
                window.binaryRight = window.binaryMid - 1;
                statusDiv.textContent = `${window.binaryData[window.binaryMid]} > ${window.binaryTarget}ï¼Œæœç´¢å·¦åŠéƒ¨åˆ†`;
            }
            
            renderBinaryArray();
        }

        function binarySearchReset() {
            binarySearchDemo(document.getElementById('algorithm-animation-container'));
        }

        // GCDç®—æ³•æ¼”ç¤º
        function gcdDemo(container) {
            const a = 48, b = 18;
            
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">æ¬§å‡ é‡Œå¾—ç®—æ³•æ¼”ç¤º (gcd(${a}, ${b}))</h4>
                    <div id="gcd-steps" class="mb-4 space-y-2"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="gcdStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="gcdReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="gcd-status" class="mt-2 text-sm text-gray-600">å¼€å§‹GCDè®¡ç®—...</p>
                </div>
            `;
            
            window.gcdA = a;
            window.gcdB = b;
            window.gcdSteps = [];
            window.gcdFinished = false;
            
            renderGcdSteps();
        }

        function renderGcdSteps() {
            const stepsDiv = document.getElementById('gcd-steps');
            if (!stepsDiv) return;
            
            stepsDiv.innerHTML = window.gcdSteps.map(step => 
                `<div class="bg-blue-100 p-2 rounded">${step}</div>`
            ).join('');
        }

        function gcdStep() {
            if (window.gcdFinished) return;
            
            const statusDiv = document.getElementById('gcd-status');
            
            if (window.gcdB === 0) {
                window.gcdSteps.push(`ç»“æœ: gcd = ${window.gcdA}`);
                statusDiv.textContent = `GCDè®¡ç®—å®Œæˆï¼Œç»“æœä¸º ${window.gcdA}`;
                window.gcdFinished = true;
            } else {
                const remainder = window.gcdA % window.gcdB;
                window.gcdSteps.push(`gcd(${window.gcdA}, ${window.gcdB}) â†’ ${window.gcdA} = ${window.gcdB} Ã— ${Math.floor(window.gcdA / window.gcdB)} + ${remainder}`);
                statusDiv.textContent = `è®¡ç®— ${window.gcdA} Ã· ${window.gcdB} çš„ä½™æ•°: ${remainder}`;
                
                window.gcdA = window.gcdB;
                window.gcdB = remainder;
            }
            
            renderGcdSteps();
        }

        function gcdReset() {
            gcdDemo(document.getElementById('algorithm-animation-container'));
        }

        // å¿«é€Ÿæ’åºæ¼”ç¤º
        function quickSortDemo(container) {
            const data = [64, 34, 25, 12, 22, 11, 90];
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">å¿«é€Ÿæ’åºæ¼”ç¤º</h4>
                    <div id="quick-array" class="flex justify-center gap-2 mb-4"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="quickSortStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="quickSortReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="quick-status" class="mt-2 text-sm text-gray-600">å‡†å¤‡å°±ç»ª...</p>
                </div>
            `;
            
            window.quickData = [...data];
            window.quickStack = [{low: 0, high: data.length - 1}];
            window.quickPhase = 'partition';
            window.quickPivot = data.length - 1;
            window.quickI = -1;
            window.quickJ = 0;
            
            renderQuickArray();
        }

        function renderQuickArray() {
            const arrayDiv = document.getElementById('quick-array');
            if (!arrayDiv || !window.quickData) return;
            
            arrayDiv.innerHTML = window.quickData.map((value, index) => {
                let bgColor = 'bg-blue-100';
                if (index === window.quickPivot) {
                    bgColor = 'bg-red-200';
                } else if (index === window.quickI + 1) {
                    bgColor = 'bg-yellow-200';
                } else if (index === window.quickJ) {
                    bgColor = 'bg-orange-200';
                }
                return `<div class="${bgColor} border-2 border-blue-300 p-2 min-w-[40px] text-center font-bold">${value}</div>`;
            }).join('');
        }

        function quickSortStep() {
            if (!window.quickData || window.quickStack.length === 0) {
                document.getElementById('quick-status').textContent = 'æ’åºå®Œæˆï¼';
                return;
            }
            
            const statusDiv = document.getElementById('quick-status');
            statusDiv.textContent = `å¿«é€Ÿæ’åºæ¼”ç¤º - åˆ†æ²»ç®—æ³•`;
            renderQuickArray();
        }

        function quickSortReset() {
            quickSortDemo(document.getElementById('algorithm-animation-container'));
        }

        // å½’å¹¶æ’åºæ¼”ç¤º
        function mergeSortDemo(container) {
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">å½’å¹¶æ’åºæ¼”ç¤º</h4>
                    <div class="bg-blue-100 p-4 rounded">åˆ†æ²»ç­–ç•¥ï¼šåˆ†è§£ â†’ è§£å†³ â†’ åˆå¹¶</div>
                </div>
            `;
        }

        // å †æ’åºæ¼”ç¤º
        function heapSortDemo(container) {
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">å †æ’åºæ¼”ç¤º</h4>
                    <div class="bg-purple-100 p-4 rounded">æ„å»ºæœ€å¤§å † â†’ æå–æœ€å¤§å€¼</div>
                </div>
            `;
        }

        // è¿›åˆ¶è½¬æ¢æ¼”ç¤º
        function binaryConversionDemo(container) {
            const num = 42;
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">è¿›åˆ¶è½¬æ¢æ¼”ç¤º (åè¿›åˆ¶ ${num} â†’ äºŒè¿›åˆ¶)</h4>
                    <div id="conversion-steps" class="mb-4 space-y-2"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="conversionStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="conversionReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="conversion-status" class="mt-2 text-sm text-gray-600">å¼€å§‹è½¬æ¢...</p>
                </div>
            `;
            
            window.conversionNum = num;
            window.conversionSteps = [];
            window.conversionResult = '';
            
            renderConversionSteps();
        }

        function renderConversionSteps() {
            const stepsDiv = document.getElementById('conversion-steps');
            if (!stepsDiv) return;
            
            stepsDiv.innerHTML = window.conversionSteps.map(step => 
                `<div class="bg-green-100 p-2 rounded">${step}</div>`
            ).join('');
        }

        function conversionStep() {
            if (window.conversionNum === 0) {
                document.getElementById('conversion-status').textContent = `ç»“æœ: ${window.conversionResult || '0'}`;
                return;
            }
            
            const remainder = window.conversionNum % 2;
            window.conversionResult = remainder + window.conversionResult;
            window.conversionSteps.push(`${window.conversionNum} Ã· 2 = ${Math.floor(window.conversionNum / 2)} ä½™ ${remainder}`);
            window.conversionNum = Math.floor(window.conversionNum / 2);
            
            renderConversionSteps();
            document.getElementById('conversion-status').textContent = `å½“å‰äºŒè¿›åˆ¶: ${window.conversionResult}`;
        }

        function conversionReset() {
            binaryConversionDemo(document.getElementById('algorithm-animation-container'));
        }

        // é€’å½’é˜¶ä¹˜æ¼”ç¤º
        function factorialDemo(container) {
            const n = 5;
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">é€’å½’é˜¶ä¹˜æ¼”ç¤º (${n}!)</h4>
                    <div id="factorial-stack" class="mb-4 space-y-1"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="factorialStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="factorialReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="factorial-status" class="mt-2 text-sm text-gray-600">å¼€å§‹é€’å½’...</p>
                </div>
            `;
            
            window.factorialN = n;
            window.factorialStack = [n];
            window.factorialPhase = 'down'; // 'down' or 'up'
            window.factorialResult = 1;
            
            renderFactorialStack();
        }

        function renderFactorialStack() {
            const stackDiv = document.getElementById('factorial-stack');
            if (!stackDiv) return;
            
            stackDiv.innerHTML = window.factorialStack.map((val, i) => 
                `<div class="bg-yellow-100 p-2 rounded border">è°ƒç”¨: factorial(${val})</div>`
            ).join('');
        }

        function factorialStep() {
            const statusDiv = document.getElementById('factorial-status');
            
            if (window.factorialPhase === 'down') {
                const current = window.factorialStack[window.factorialStack.length - 1];
                if (current > 1) {
                    window.factorialStack.push(current - 1);
                    statusDiv.textContent = `é€’å½’è°ƒç”¨: factorial(${current - 1})`;
                } else {
                    window.factorialPhase = 'up';
                    statusDiv.textContent = 'å¼€å§‹è¿”å›å€¼...';
                }
            } else {
                if (window.factorialStack.length > 0) {
                    const current = window.factorialStack.pop();
                    window.factorialResult *= current;
                    statusDiv.textContent = `è¿”å›: factorial(${current}) = ${window.factorialResult}`;
                } else {
                    statusDiv.textContent = `æœ€ç»ˆç»“æœ: ${window.factorialN}! = ${window.factorialResult}`;
                }
            }
            
            renderFactorialStack();
        }

        function factorialReset() {
            factorialDemo(document.getElementById('algorithm-animation-container'));
        }

        // æ–æ³¢é‚£å¥‘DPæ¼”ç¤º
        function fibonacciDemo(container) {
            const n = 7;
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">æ–æ³¢é‚£å¥‘DPæ¼”ç¤º (F(${n}))</h4>
                    <div id="fib-table" class="grid grid-cols-8 gap-1 max-w-md mx-auto mb-4"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="fibonacciStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="fibonacciReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="fib-status" class="mt-2 text-sm text-gray-600">åˆå§‹åŒ–DPæ•°ç»„...</p>
                </div>
            `;
            
            window.fibN = n;
            window.fibDP = new Array(n + 1).fill(-1);
            window.fibDP[0] = 0;
            window.fibDP[1] = 1;
            window.fibI = 2;
            
            renderFibTable();
        }

        function renderFibTable() {
            const tableDiv = document.getElementById('fib-table');
            if (!tableDiv) return;
            
            tableDiv.innerHTML = window.fibDP.map((val, i) => {
                let bgColor = val === -1 ? 'bg-gray-200' : 'bg-green-200';
                if (i === window.fibI) bgColor = 'bg-yellow-200';
                return `<div class="${bgColor} border p-2 text-center text-xs">F(${i})=${val === -1 ? '?' : val}</div>`;
            }).join('');
        }

        function fibonacciStep() {
            if (window.fibI > window.fibN) {
                document.getElementById('fib-status').textContent = `ç»“æœ: F(${window.fibN}) = ${window.fibDP[window.fibN]}`;
                return;
            }
            
            window.fibDP[window.fibI] = window.fibDP[window.fibI - 1] + window.fibDP[window.fibI - 2];
            document.getElementById('fib-status').textContent = `è®¡ç®— F(${window.fibI}) = F(${window.fibI - 1}) + F(${window.fibI - 2}) = ${window.fibDP[window.fibI]}`;
            window.fibI++;
            
            renderFibTable();
        }

        function fibonacciReset() {
            fibonacciDemo(document.getElementById('algorithm-animation-container'));
        }

        // æ ˆæ“ä½œæ¼”ç¤º
        function stackDemo(container) {
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">æ ˆæ“ä½œæ¼”ç¤º (LIFO)</h4>
                    <div id="stack-visual" class="flex flex-col-reverse items-center mb-4 h-40"></div>
                    <div class="flex gap-2 justify-center mb-2">
                        <button onclick="stackPush()" class="px-4 py-2 bg-blue-500 text-white rounded">Push(5)</button>
                        <button onclick="stackPop()" class="px-4 py-2 bg-red-500 text-white rounded">Pop</button>
                        <button onclick="stackReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="stack-status" class="text-sm text-gray-600">æ ˆä¸ºç©º</p>
                </div>
            `;
            
            window.stackData = [];
            window.stackCounter = 1;
            renderStack();
        }

        function renderStack() {
            const stackDiv = document.getElementById('stack-visual');
            if (!stackDiv) return;
            
            stackDiv.innerHTML = window.stackData.map(val => 
                `<div class="bg-blue-200 border-2 border-blue-400 p-2 m-1 min-w-[60px] text-center font-bold">${val}</div>`
            ).join('');
        }

        function stackPush() {
            window.stackData.push(window.stackCounter++);
            document.getElementById('stack-status').textContent = `å…ƒç´ å…¥æ ˆï¼Œæ ˆå¤§å°: ${window.stackData.length}`;
            renderStack();
        }

        function stackPop() {
            if (window.stackData.length > 0) {
                const popped = window.stackData.pop();
                document.getElementById('stack-status').textContent = `å¼¹å‡ºå…ƒç´ : ${popped}ï¼Œæ ˆå¤§å°: ${window.stackData.length}`;
            } else {
                document.getElementById('stack-status').textContent = 'æ ˆä¸ºç©ºï¼Œæ— æ³•å¼¹å‡º';
            }
            renderStack();
        }

        function stackReset() {
            stackDemo(document.getElementById('algorithm-animation-container'));
        }

        // é˜Ÿåˆ—æ“ä½œæ¼”ç¤º
        function queueDemo(container) {
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">é˜Ÿåˆ—æ“ä½œæ¼”ç¤º (FIFO)</h4>
                    <div id="queue-visual" class="flex items-center justify-center mb-4 h-20"></div>
                    <div class="flex gap-2 justify-center mb-2">
                        <button onclick="queuePush()" class="px-4 py-2 bg-blue-500 text-white rounded">Enqueue</button>
                        <button onclick="queuePop()" class="px-4 py-2 bg-red-500 text-white rounded">Dequeue</button>
                        <button onclick="queueReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="queue-status" class="text-sm text-gray-600">é˜Ÿåˆ—ä¸ºç©º</p>
                </div>
            `;
            
            window.queueData = [];
            window.queueCounter = 1;
            renderQueue();
        }

        function renderQueue() {
            const queueDiv = document.getElementById('queue-visual');
            if (!queueDiv) return;
            
            queueDiv.innerHTML = window.queueData.map((val, i) => {
                const isFirst = i === 0;
                const isLast = i === window.queueData.length - 1;
                return `<div class="bg-green-200 border-2 ${isFirst ? 'border-red-400' : isLast ? 'border-blue-400' : 'border-green-400'} p-2 m-1 min-w-[50px] text-center font-bold">${val}</div>`;
            }).join('') + (window.queueData.length === 0 ? '<div class="text-gray-400">ç©ºé˜Ÿåˆ—</div>' : '');
        }

        function queuePush() {
            window.queueData.push(window.queueCounter++);
            document.getElementById('queue-status').textContent = `å…ƒç´ å…¥é˜Ÿï¼Œé˜Ÿåˆ—å¤§å°: ${window.queueData.length}`;
            renderQueue();
        }

        function queuePop() {
            if (window.queueData.length > 0) {
                const dequeued = window.queueData.shift();
                document.getElementById('queue-status').textContent = `å‡ºé˜Ÿå…ƒç´ : ${dequeued}ï¼Œé˜Ÿåˆ—å¤§å°: ${window.queueData.length}`;
            } else {
                document.getElementById('queue-status').textContent = 'é˜Ÿåˆ—ä¸ºç©ºï¼Œæ— æ³•å‡ºé˜Ÿ';
            }
            renderQueue();
        }

        function queueReset() {
            queueDemo(document.getElementById('algorithm-animation-container'));
        }

        // çº¿æ€§æœç´¢æ¼”ç¤º
        function linearSearchDemo(container) {
            const data = [3, 7, 14, 19, 25, 31, 38, 42];
            const target = 25;
            
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">çº¿æ€§æŸ¥æ‰¾æ¼”ç¤º (æŸ¥æ‰¾: ${target})</h4>
                    <div id="linear-array" class="flex justify-center gap-2 mb-4"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="linearSearchStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="linearSearchReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="linear-status" class="mt-2 text-sm text-gray-600">å¼€å§‹æœç´¢...</p>
                </div>
            `;
            
            window.linearData = [...data];
            window.linearTarget = target;
            window.linearIndex = 0;
            window.linearFound = false;
            
            renderLinearArray();
        }

        function renderLinearArray() {
            const arrayDiv = document.getElementById('linear-array');
            if (!arrayDiv || !window.linearData) return;
            
            arrayDiv.innerHTML = window.linearData.map((value, index) => {
                let bgColor = 'bg-blue-100';
                if (index === window.linearIndex && !window.linearFound) {
                    bgColor = 'bg-yellow-200';
                } else if (value === window.linearTarget && window.linearFound) {
                    bgColor = 'bg-green-200';
                } else if (index < window.linearIndex) {
                    bgColor = 'bg-gray-200';
                }
                return `<div class="${bgColor} border-2 border-blue-300 p-2 min-w-[40px] text-center font-bold">${value}</div>`;
            }).join('');
        }

        function linearSearchStep() {
            if (!window.linearData || window.linearFound) return;
            
            const statusDiv = document.getElementById('linear-status');
            
            if (window.linearIndex >= window.linearData.length) {
                statusDiv.textContent = 'æœªæ‰¾åˆ°ç›®æ ‡å€¼';
                return;
            }
            
            if (window.linearData[window.linearIndex] === window.linearTarget) {
                window.linearFound = true;
                statusDiv.textContent = `æ‰¾åˆ°ç›®æ ‡å€¼ ${window.linearTarget} åœ¨ä½ç½® ${window.linearIndex}`;
            } else {
                statusDiv.textContent = `æ£€æŸ¥ä½ç½® ${window.linearIndex}: ${window.linearData[window.linearIndex]} â‰  ${window.linearTarget}`;
                window.linearIndex++;
            }
            
            renderLinearArray();
        }

        function linearSearchReset() {
            linearSearchDemo(document.getElementById('algorithm-animation-container'));
        }

        // è´¨æ•°ç­›æ³•æ¼”ç¤º
        function primeSieveDemo(container) {
            const n = 20;
            container.innerHTML = `
                <div class="text-center">
                    <h4 class="font-bold mb-4">åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•æ¼”ç¤º (n=${n})</h4>
                    <div id="sieve-grid" class="grid grid-cols-10 gap-1 justify-center mb-4 max-w-md mx-auto"></div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="sieveStep()" class="px-4 py-2 bg-green-500 text-white rounded">ä¸‹ä¸€æ­¥</button>
                        <button onclick="sieveReset()" class="px-4 py-2 bg-gray-500 text-white rounded">é‡ç½®</button>
                    </div>
                    <p id="sieve-status" class="mt-2 text-sm text-gray-600">åˆå§‹åŒ–ç­›å­...</p>
                </div>
            `;
            
            window.sieveData = new Array(n + 1).fill(true);
            window.sieveData[0] = window.sieveData[1] = false;
            window.sieveI = 2;
            window.sieveJ = 0;
            
            renderSieveGrid();
        }

        function renderSieveGrid() {
            const gridDiv = document.getElementById('sieve-grid');
            if (!gridDiv || !window.sieveData) return;
            
            gridDiv.innerHTML = window.sieveData.map((isPrime, num) => {
                let bgColor = 'bg-blue-100';
                let textColor = 'text-black';
                
                if (num === 0 || num === 1) {
                    bgColor = 'bg-gray-300';
                    textColor = 'text-gray-500';
                } else if (!isPrime) {
                    bgColor = 'bg-red-200';
                    textColor = 'text-red-700';
                } else if (num === window.sieveI) {
                    bgColor = 'bg-yellow-300';
                } else if (isPrime && num < window.sieveI) {
                    bgColor = 'bg-green-200';
                    textColor = 'text-green-700';
                }
                
                return `<div class="${bgColor} ${textColor} border border-gray-400 p-1 text-xs font-bold text-center min-w-[24px] min-h-[24px] flex items-center justify-center">${num}</div>`;
            }).join('');
        }

        function sieveStep() {
            if (!window.sieveData) return;
            
            const n = window.sieveData.length - 1;
            const statusDiv = document.getElementById('sieve-status');
            
            if (window.sieveI * window.sieveI > n) {
                const primes = [];
                for (let i = 2; i <= n; i++) {
                    if (window.sieveData[i]) primes.push(i);
                }
                statusDiv.textContent = `ç­›æ³•å®Œæˆï¼è´¨æ•°: ${primes.join(', ')}`;
                return;
            }
            
            if (window.sieveData[window.sieveI]) {
                if (window.sieveJ === 0) {
                    window.sieveJ = window.sieveI * window.sieveI;
                    statusDiv.textContent = `è´¨æ•° ${window.sieveI} å¼€å§‹æ ‡è®°å€æ•°`;
                } else if (window.sieveJ <= n) {
                    window.sieveData[window.sieveJ] = false;
                    statusDiv.textContent = `æ ‡è®° ${window.sieveJ} = ${window.sieveI} Ã— ${window.sieveJ / window.sieveI} ä¸ºåˆæ•°`;
                    window.sieveJ += window.sieveI;
                } else {
                    window.sieveI++;
                    window.sieveJ = 0;
                }
            } else {
                window.sieveI++;
                window.sieveJ = 0;
            }
            
            renderSieveGrid();
        }

        function sieveReset() {
            primeSieveDemo(document.getElementById('algorithm-animation-container'));
        }

        // é»˜è®¤æ¼”ç¤ºï¼ˆç”¨äºå…¶ä»–ç®—æ³•ï¼‰
        function defaultDemo(container, algorithm) {
            container.innerHTML = `
                <div class="text-center p-8">
                    <div class="text-6xl mb-4">ğŸ“š</div>
                    <h4 class="font-bold text-lg mb-2">${algorithm} ç®—æ³•æ¼”ç¤º</h4>
                    <p class="text-gray-600 mb-4">è¯¥ç®—æ³•çš„è¯¦ç»†åŠ¨ç”»æ¼”ç¤ºæ­£åœ¨å¼€å‘ä¸­...</p>
                    <div class="animate-pulse bg-blue-100 h-20 rounded-lg flex items-center justify-center">
                        <span class="text-blue-600 font-medium">åŠ¨ç”»æ¼”ç¤ºåŒºåŸŸ</span>
                    </div>
                </div>
            `;
        }

        // å¯åŠ¨æ•™ç¨‹
        function startTutorial() {
            const algorithm = document.getElementById('specific-algorithm').value;
            if (window.tutorialSystem && algorithm) {
                window.tutorialSystem.startTutorial(algorithm);
            }
        }

        // åˆå§‹åŒ–ç§»åŠ¨ç«¯ä¼˜åŒ–
        function initMobileOptimization() {
            if (window.MobileOptimization) {
                const mobileOpt = new MobileOptimization();
                mobileOpt.init();
                alert('ç§»åŠ¨ç«¯ä¼˜åŒ–å·²å¯ç”¨ï¼');
            } else {
                alert('ç§»åŠ¨ç«¯ä¼˜åŒ–æ¨¡å—æœªåŠ è½½ï¼');
            }
        }

        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ¯ CSP-J ç®—æ³•å¯è§†åŒ–ç³»ç»Ÿå®Œæ•´ç‰ˆå·²å°±ç»ªï¼');
            console.log('âœ¨ åŠŸèƒ½åŒ…æ‹¬ï¼š');
            console.log('  - ğŸ® äº¤äº’å¼ç®—æ³•å¯è§†åŒ–');
            console.log('  - âŒ¨ï¸ é”®ç›˜å¿«æ·é”®æ”¯æŒ');
            console.log('  - ğŸ“š äº’åŠ¨æ•™ç¨‹ç³»ç»Ÿ');
            console.log('  - ğŸ§ª è‡ªåŠ¨æµ‹è¯•å¥—ä»¶');
            console.log('  - ğŸ¨ å¢å¼ºUIä½“éªŒ');
            console.log('ğŸ’¡ æç¤ºï¼šç‚¹å‡»å³ä¾§æŒ‰é’®æ¢ç´¢å„ç§åŠŸèƒ½ï¼');
        });
    </script>
</body>
</html>