<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿«é€ŸéªŒè¯ - CSP-J Studio</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .test-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .test-card h3 {
            margin-top: 0;
            color: #333;
        }

        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .status.success {
            background: #10b981;
            color: white;
        }

        .status.error {
            background: #ef4444;
            color: white;
        }

        .status.pending {
            background: #f59e0b;
            color: white;
        }

        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }

        button:hover {
            background: #2563eb;
        }

        .result {
            margin-top: 10px;
            padding: 10px;
            background: #f3f4f6;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }

        .link-button {
            display: inline-block;
            background: #8b5cf6;
            color: white;
            text-decoration: none;
            padding: 12px 24px;
            border-radius: 6px;
            margin: 10px 5px;
        }

        .link-button:hover {
            background: #7c3aed;
        }
    </style>
</head>

<body>
    <h1>ğŸ§ª CSP-J Studio å¿«é€ŸéªŒè¯å·¥å…·</h1>

    <div class="test-card">
        <h3>ğŸ“‹ éªŒè¯æ­¥éª¤</h3>
        <p>è¿™ä¸ªé¡µé¢å°†å¸®åŠ©æ‚¨å¿«é€ŸéªŒè¯æ–°åˆ›å»ºçš„ <code>csp-j-studio-complete.html</code> æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>

        <a href="csp-j-studio-complete.html" class="link-button" target="_blank">
            ğŸš€ æ‰“å¼€ CSP-J Studio Complete
        </a>

        <a href="csp-j-optimized-fixed.html" class="link-button" target="_blank">
            âš ï¸ æ‰“å¼€æŸåçš„ç‰ˆæœ¬ï¼ˆå¯¹æ¯”ç”¨ï¼‰
        </a>
    </div>

    <div class="test-card">
        <h3>1ï¸âƒ£ æ£€æŸ¥ä¾èµ–è„šæœ¬ <span id="status-1" class="status pending">å¾…æ£€æµ‹</span></h3>
        <button onclick="checkDependencies()">å¼€å§‹æ£€æµ‹</button>
        <div id="result-1" class="result" style="display:none;"></div>
    </div>

    <div class="test-card">
        <h3>2ï¸âƒ£ æ£€æŸ¥å¯è§†åŒ–å™¨ç±» <span id="status-2" class="status pending">å¾…æ£€æµ‹</span></h3>
        <button onclick="checkVisualizers()">å¼€å§‹æ£€æµ‹</button>
        <div id="result-2" class="result" style="display:none;"></div>
    </div>

    <div class="test-card">
        <h3>3ï¸âƒ£ æ£€æŸ¥é¡µé¢å…ƒç´  <span id="status-3" class="status pending">å¾…æ£€æµ‹</span></h3>
        <button onclick="checkElements()">å¼€å§‹æ£€æµ‹</button>
        <div id="result-3" class="result" style="display:none;"></div>
    </div>

    <div class="test-card">
        <h3>4ï¸âƒ£ æµ‹è¯•åŸºæœ¬åŠŸèƒ½ <span id="status-4" class="status pending">å¾…æ£€æµ‹</span></h3>
        <p>æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤ï¼š</p>
        <ol style="line-height: 1.8;">
            <li>åœ¨æ–°çª—å£ä¸­æ‰“å¼€ CSP-J Studio Complete</li>
            <li>ç‚¹å‡»"ğŸ”„ æ’åºç®—æ³•"å¡ç‰‡</li>
            <li>ä»ä¸‹æ‹‰æ¡†é€‰æ‹©"å†’æ³¡æ’åº"</li>
            <li>æŸ¥çœ‹å¯è§†åŒ–æ˜¯å¦æ­£å¸¸æ˜¾ç¤º</li>
            <li>æµ‹è¯•æ’­æ”¾/æš‚åœæŒ‰é’®</li>
        </ol>
        <button onclick="markTestComplete()">âœ… æ‰‹åŠ¨æµ‹è¯•é€šè¿‡</button>
        <button onclick="markTestFailed()">âŒ æµ‹è¯•å¤±è´¥</button>
        <div id="result-4" class="result" style="display:none;"></div>
    </div>

    <div class="test-card">
        <h3>ğŸ“Š æµ‹è¯•æ€»ç»“</h3>
        <div id="summary">
            <p>è¯·å…ˆè¿è¡Œä¸Šé¢çš„æµ‹è¯•...</p>
        </div>
    </div>

    <script>
        let testResults = {
            dependencies: null,
            visualizers: null,
            elements: null,
            manual: null
        };

        function updateStatus(testNum, status, message) {
            const statusEl = document.getElementById(`status-${testNum}`);
            const resultEl = document.getElementById(`result-${testNum}`);

            statusEl.className = `status ${status}`;
            statusEl.textContent = status === 'success' ? 'é€šè¿‡' : status === 'error' ? 'å¤±è´¥' : 'å¾…æ£€æµ‹';

            if (message) {
                resultEl.style.display = 'block';
                resultEl.innerHTML = message;
            }

            updateSummary();
        }

        function checkDependencies() {
            const scripts = [
                'algorithm-visualizer.js',
                'algorithm-visualizer-enhanced.js',
                'additional-algorithms.js',
                'utils/VisualizerFactory.js'
            ];

            let results = [];
            let allFound = true;

            scripts.forEach(script => {
                fetch(script, { method: 'HEAD' })
                    .then(response => {
                        const exists = response.ok;
                        results.push(`${script}: ${exists ? 'âœ… å­˜åœ¨' : 'âŒ ç¼ºå¤±'}`);
                        if (!exists) allFound = false;
                    })
                    .catch(() => {
                        results.push(`${script}: âŒ æ— æ³•è®¿é—®`);
                        allFound = false;
                    })
                    .finally(() => {
                        if (results.length === scripts.length) {
                            testResults.dependencies = allFound;
                            updateStatus(1, allFound ? 'success' : 'error', results.join('<br>'));
                        }
                    });
            });
        }

        function checkVisualizers() {
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = 'csp-j-studio-complete.html';

            iframe.onload = function () {
                try {
                    const win = iframe.contentWindow;
                    const checks = {
                        'SortingVisualizer': typeof win.SortingVisualizer !== 'undefined',
                        'SearchVisualizer': typeof win.SearchVisualizer !== 'undefined',
                        'EnhancedSortingVisualizer': typeof win.EnhancedSortingVisualizer !== 'undefined',
                        'EnhancedSearchVisualizer': typeof win.EnhancedSearchVisualizer !== 'undefined',
                        'GraphVisualizer': typeof win.GraphVisualizer !== 'undefined',
                        'DynamicProgrammingVisualizer': typeof win.DynamicProgrammingVisualizer !== 'undefined',
                        'VisualizerFactory': typeof win.VisualizerFactory !== 'undefined'
                    };

                    const results = Object.entries(checks).map(([name, exists]) =>
                        `${name}: ${exists ? 'âœ… å·²å®šä¹‰' : 'âŒ æœªå®šä¹‰'}`
                    );

                    const allDefined = Object.values(checks).every(v => v);
                    testResults.visualizers = allDefined;

                    updateStatus(2, allDefined ? 'success' : 'error', results.join('<br>'));

                    document.body.removeChild(iframe);
                } catch (e) {
                    testResults.visualizers = false;
                    updateStatus(2, 'error', `æ£€æµ‹å¤±è´¥: ${e.message}`);
                    document.body.removeChild(iframe);
                }
            };

            document.body.appendChild(iframe);
        }

        function checkElements() {
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = 'csp-j-studio-complete.html';

            iframe.onload = function () {
                try {
                    const doc = iframe.contentDocument;
                    const checks = {
                        'æ ‡é¢˜å…ƒç´ ': !!doc.querySelector('h1'),
                        'ç®—æ³•é€‰æ‹©å™¨': !!doc.getElementById('algorithm-selector'),
                        'å…·ä½“ç®—æ³•ä¸‹æ‹‰æ¡†': !!doc.getElementById('specific-algorithm'),
                        'å¯è§†åŒ–å®¹å™¨': !!doc.getElementById('visualization-container'),
                        'viz-content': !!doc.getElementById('viz-content'),
                        'ç®—æ³•å¡ç‰‡': doc.querySelectorAll('.algorithm-card').length > 0
                    };

                    const results = Object.entries(checks).map(([name, exists]) =>
                        `${name}: ${exists ? 'âœ… å­˜åœ¨' : 'âŒ ç¼ºå¤±'}`
                    );

                    const allFound = Object.values(checks).every(v => v);
                    testResults.elements = allFound;

                    updateStatus(3, allFound ? 'success' : 'error', results.join('<br>'));

                    document.body.removeChild(iframe);
                } catch (e) {
                    testResults.elements = false;
                    updateStatus(3, 'error', `æ£€æµ‹å¤±è´¥: ${e.message}`);
                    document.body.removeChild(iframe);
                }
            };

            document.body.appendChild(iframe);
        }

        function markTestComplete() {
            testResults.manual = true;
            updateStatus(4, 'success', 'âœ… æ‰‹åŠ¨æµ‹è¯•å·²é€šè¿‡ï¼ŒåŠŸèƒ½æ­£å¸¸');
        }

        function markTestFailed() {
            const reason = prompt('è¯·æè¿°å¤±è´¥åŸå› ï¼š');
            testResults.manual = false;
            updateStatus(4, 'error', `âŒ æµ‹è¯•å¤±è´¥ï¼š${reason || 'æœªæä¾›åŸå› '}`);
        }

        function updateSummary() {
            const summary = document.getElementById('summary');
            const completed = Object.values(testResults).filter(v => v !== null).length;
            const passed = Object.values(testResults).filter(v => v === true).length;
            const total = Object.keys(testResults).length;

            let html = `<p><strong>è¿›åº¦ï¼š</strong>${completed}/${total} é¡¹æµ‹è¯•å·²å®Œæˆ</p>`;

            if (completed === total) {
                if (passed === total) {
                    html += `<p style="color: #10b981; font-size: 18px; font-weight: bold;">âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼CSP-J Studio Complete å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p>`;
                    html += `<p>å»ºè®®ï¼šå°† <code>csp-j-studio-complete.html</code> ä½œä¸ºä¸»è¦å­¦ä¹ å·¥å…·ã€‚</p>`;
                } else {
                    html += `<p style="color: #ef4444; font-size: 18px; font-weight: bold;">âŒ ${total - passed} é¡¹æµ‹è¯•å¤±è´¥</p>`;
                    html += `<p>è¯·æŸ¥çœ‹ä¸Šé¢çš„æµ‹è¯•ç»“æœï¼Œå¹¶æ£€æŸ¥ç›¸å…³æ–‡ä»¶å’Œä¾èµ–ã€‚</p>`;
                }
            }

            summary.innerHTML = html;
        }

        // åˆå§‹åŒ–
        window.onload = function () {
            console.log('éªŒè¯å·¥å…·å·²åŠ è½½');
        };
    </script>
</body>

</html>