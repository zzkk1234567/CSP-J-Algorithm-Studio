<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ† CSP-J å®Œæ•´å¤‡è€ƒå­¦ä¹ åŠ©æ‰‹</title>
    <link href="https://cdn.tailwindcss.com" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <style>
        .code-font { font-family: 'Fira Code', 'Consolas', monospace; }
        .detective { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            width: 80px;
            height: 80px;
            position: relative;
        }
        .detective::before {
            content: "ğŸ•µï¸";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
        }
        .speech-bubble {
            position: relative;
            background: white;
            border-radius: 20px;
            padding: 15px;
            margin-left: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .speech-bubble::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 20px;
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 10px solid white;
        }
        .algorithm-viz {
            min-height: 200px;
            background: #1e293b;
            border-radius: 8px;
            padding: 20px;
            color: white;
            font-family: monospace;
        }
        .array-bar {
            display: inline-block;
            width: 30px;
            margin: 2px;
            text-align: center;
            color: white;
            font-weight: bold;
            transition: all 0.5s ease;
        }
        .tab-active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <span class="text-2xl">ğŸ†</span>
                    <h1 class="text-xl font-bold text-gray-800">CSP-J å®Œæ•´å¤‡è€ƒå­¦ä¹ åŠ©æ‰‹</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="bg-blue-100 px-3 py-1 rounded-full">
                        <span class="text-sm text-blue-800">å­¦ä¹ è¿›åº¦: <span id="overall-progress">0%</span></span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-6">
        <div class="flex items-center mb-6">
            <div class="detective"></div>
            <div class="speech-bubble flex-1">
                <p id="detective-message" class="text-gray-700 font-medium">
                    ğŸ¯ æ¬¢è¿æ¥åˆ°CSP-Jå®Œæ•´å­¦ä¹ ä¸–ç•Œï¼åŒ…å«8å¤§çŸ¥è¯†æ¨¡å—ã€50+çœŸé¢˜ã€å®Œæ•´ä»£ç åº“ï¼
                </p>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4">
        <div class="flex bg-white rounded-lg shadow-md mb-6 overflow-hidden">
            <button onclick="switchTab('knowledge')" id="tab-knowledge" class="tab-active px-6 py-3 font-medium flex-1 transition-all">
                ğŸ“š å®Œæ•´çŸ¥è¯†ç‚¹
            </button>
            <button onclick="switchTab('practice')" id="tab-practice" class="px-6 py-3 font-medium flex-1 transition-all hover:bg-gray-50">
                ğŸ’» ç¼–ç¨‹ç»ƒä¹ 
            </button>
            <button onclick="switchTab('interactive')" id="tab-interactive" class="px-6 py-3 font-medium flex-1 transition-all hover:bg-gray-50">
                ğŸ® ç®—æ³•å¯è§†åŒ–
            </button>
            <button onclick="switchTab('test')" id="tab-test" class="px-6 py-3 font-medium flex-1 transition-all hover:bg-gray-50">
                ğŸ“ å†å¹´çœŸé¢˜
            </button>
        </div>
    </div>

    <main class="container mx-auto px-4 pb-10">
        <!-- çŸ¥è¯†è®²è§£åŒº -->
        <div id="content-knowledge" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">ğŸ“‹ CSP-Jå®Œæ•´çŸ¥è¯†ä½“ç³»</h3>
                        <div class="space-y-2" id="knowledge-nav">
                            <!-- åŠ¨æ€ç”Ÿæˆå®Œæ•´çŸ¥è¯†ç‚¹å¯¼èˆª -->
                        </div>
                    </div>
                </div>
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <div id="knowledge-content">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">CSP-J å®Œæ•´çŸ¥è¯†ä½“ç³»</h2>
                            <p class="text-gray-600 mb-4">é€‰æ‹©å·¦ä¾§çŸ¥è¯†ç‚¹æŸ¥çœ‹è¯¦ç»†è®²è§£ã€çœŸé¢˜è§£æå’Œä»£ç ç¤ºä¾‹ã€‚</p>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-bold text-blue-800 mb-2">æœ¬å·¥å…·å®Œæ•´å†…å®¹ï¼š</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <h5 class="font-semibold text-blue-700">çŸ¥è¯†æ¨¡å—ï¼š</h5>
                                        <ul class="text-blue-700 text-sm space-y-1">
                                            <li>â€¢ ç«èµ›ä¸CCFç®€ä»‹</li>
                                            <li>â€¢ æ•°æ®è¡¨ç¤ºä¸è¿›åˆ¶</li>
                                            <li>â€¢ é€»è¾‘è¿ç®—ä¸çŸ­è·¯</li>
                                            <li>â€¢ åŸºæœ¬æ•°æ®ç»“æ„</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h5 class="font-semibold text-blue-700">å®è·µå†…å®¹ï¼š</h5>
                                        <ul class="text-blue-700 text-sm space-y-1">
                                            <li>â€¢ åŸºç¡€ç®—æ³•æ€æƒ³</li>
                                            <li>â€¢ C++ç¨‹åºè®¾è®¡</li>
                                            <li>â€¢ æ–‡ä»¶è¾“å…¥è¾“å‡º</li>
                                            <li>â€¢ åº”è¯•æŠ€å·§ç»éªŒ</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="mt-4 pt-3 border-t border-blue-200">
                                    <p class="text-sm text-blue-600">
                                        <strong>ğŸ“ˆ å­¦ä¹ å»ºè®®ï¼š</strong>æŒ‰é¡ºåºå­¦ä¹ å„æ¨¡å—ï¼Œå®Œæˆæ¯ä¸ªçŸ¥è¯†ç‚¹åè¿›è¡Œç¼–ç¨‹ç»ƒä¹ ï¼Œæœ€åé€šè¿‡çœŸé¢˜æµ‹è¯•æ£€éªŒå­¦ä¹ æ•ˆæœã€‚
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¼–ç¨‹ç»ƒä¹ åŒº -->
        <div id="content-practice" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ğŸ’» ä»£ç ç¼–è¾‘å™¨</h3>
                    <div class="mb-4">
                        <select id="code-template" onchange="loadCodeTemplate()" class="w-full p-2 border rounded-md">
                            <option value="">é€‰æ‹©ä»£ç æ¨¡æ¿</option>
                            <option value="hello">Hello World - åŸºç¡€ç¨‹åºç»“æ„</option>
                            <option value="input">è¾“å…¥è¾“å‡º - æ•°æ®è¯»å–ä¸è¾“å‡º</option>
                            <option value="array">æ•°ç»„æ“ä½œ - æ•°ç»„å£°æ˜ä¸éå†</option>
                            <option value="function">å‡½æ•°å®šä¹‰ - å‡½æ•°å£°æ˜ä¸è°ƒç”¨</option>
                            <option value="recursion">é€’å½’ç®—æ³• - é€’å½’æ€æƒ³åº”ç”¨</option>
                            <option value="file_io">æ–‡ä»¶æ“ä½œ - æ–‡ä»¶è¯»å†™å¤„ç†</option>
                            <option value="binary_search">äºŒåˆ†æŸ¥æ‰¾ - é«˜æ•ˆæœç´¢ç®—æ³•</option>
                            <option value="bubble_sort">æ’åºç®—æ³• - å†’æ³¡ä¸é€‰æ‹©æ’åº</option>
                            <option value="data_types">æ•°æ®ç±»å‹ - åŸºæœ¬ç±»å‹è¯¦è§£</option>
                            <option value="control_structures">æ§åˆ¶ç»“æ„ - åˆ†æ”¯ä¸å¾ªç¯</option>
                        </select>
                    </div>
                    <textarea id="code-editor" class="w-full code-font h-64 p-3 border rounded">#include <iostream>
using namespace std;

int main() {
    cout << "Hello, CSP-J!" << endl;
    return 0;
}</textarea>
                    <div class="mt-4 flex gap-2">
                        <button onclick="runCode()" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition-colors">
                            â–¶ï¸ è¿è¡Œä»£ç 
                        </button>
                        <button onclick="clearCode()" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors">
                            ğŸ—‘ï¸ æ¸…ç©ºä»£ç 
                        </button>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ğŸ“¤ è¿è¡Œç»“æœ</h3>
                    <div id="code-output" class="bg-gray-900 text-green-400 p-4 rounded-md code-font min-h-[200px] overflow-auto">
                        ç‚¹å‡»"è¿è¡Œä»£ç "æŸ¥çœ‹ç»“æœ...
                    </div>
                    <div class="mt-4 bg-blue-50 p-3 rounded-lg text-sm">
                        <h5 class="font-semibold text-blue-800 mb-2">ğŸ’¡ ç¼–ç¨‹æç¤ºï¼š</h5>
                        <ul class="text-blue-700 space-y-1">
                            <li>â€¢ é€‰æ‹©æ¨¡æ¿å¿«é€Ÿå¼€å§‹ç¼–ç¨‹</li>
                            <li>â€¢ æ³¨æ„ç¨‹åºçš„è¾“å…¥è¾“å‡ºæ ¼å¼</li>
                            <li>â€¢ å…»æˆè‰¯å¥½çš„ä»£ç æ³¨é‡Šä¹ æƒ¯</li>
                            <li>â€¢ æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œç‰¹æ®Šæƒ…å†µ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç®—æ³•å¯è§†åŒ–åŒº -->
        <div id="content-interactive" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ğŸ¯ ç®—æ³•å¯è§†åŒ–</h3>
                    <div class="mb-4">
                        <select id="algorithm-select" onchange="showAlgorithmViz()" class="w-full p-2 border rounded-md">
                            <option value="">é€‰æ‹©ç®—æ³•æ¼”ç¤º</option>
                            <option value="bubble-sort">å†’æ³¡æ’åº - ç›¸é‚»å…ƒç´ äº¤æ¢</option>
                            <option value="selection-sort">é€‰æ‹©æ’åº - é€‰æ‹©æœ€å°å…ƒç´ </option>
                            <option value="binary-search">äºŒåˆ†æŸ¥æ‰¾ - æœ‰åºæ•°ç»„æœç´¢</option>
                            <option value="linear-search">çº¿æ€§æŸ¥æ‰¾ - é¡ºåºéå†æœç´¢</option>
                            <option value="factorial">é€’å½’é˜¶ä¹˜ - é€’å½’è°ƒç”¨æ¼”ç¤º</option>
                        </select>
                    </div>
                    <div id="algorithm-visualization" class="algorithm-viz">
                        é€‰æ‹©ç®—æ³•æŸ¥çœ‹å¯è§†åŒ–æ¼”ç¤º...
                    </div>
                    <div class="mt-4 flex gap-2">
                        <button onclick="startVisualization()" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors">
                            â–¶ï¸ å¼€å§‹æ¼”ç¤º
                        </button>
                        <button onclick="resetVisualization()" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors">
                            ğŸ”„ é‡ç½®
                        </button>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ğŸ§© ä»£ç å—æ‹–æ‹½ç»ƒä¹ </h3>
                    <p class="text-gray-600 mb-4">å°†ä¸‹é¢çš„ä»£ç å—æŒ‰æ­£ç¡®é¡ºåºæ‹–æ‹½ç»„åˆï¼š</p>
                    <div id="drag-drop-area" class="border-2 border-dashed border-gray-300 p-4 rounded-md min-h-[200px] mb-4 bg-gray-50">
                        <div class="text-center text-gray-500 py-8">
                            å°†ä»£ç å—æ‹–æ‹½åˆ°è¿™é‡Œ
                        </div>
                    </div>
                    <div id="code-blocks" class="grid grid-cols-1 gap-2">
                        <!-- åŠ¨æ€ç”Ÿæˆä»£ç å— -->
                    </div>
                    <button onclick="checkCodeOrder()" class="mt-4 bg-purple-500 text-white px-4 py-2 rounded-md hover:bg-purple-600 transition-colors">
                        âœ… æ£€æŸ¥ç­”æ¡ˆ
                    </button>
                </div>
            </div>
        </div>

        <!-- å†å¹´çœŸé¢˜æµ‹è¯•åŒº -->
        <div id="content-test" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-bold text-gray-800">ğŸ“ CSP-J å†å¹´çœŸé¢˜æµ‹è¯•</h3>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-red-500" id="test-timer">15:00</div>
                        <div class="text-sm text-gray-500">å‰©ä½™æ—¶é—´</div>
                    </div>
                </div>
                <div id="test-area">
                    <div class="text-center py-8">
                        <div class="mb-6">
                            <div class="text-4xl mb-4">ğŸ†</div>
                            <p class="text-xl font-bold text-gray-800 mb-2">CSP-J å†å¹´çœŸé¢˜æŒ‘æˆ˜</p>
                            <p class="text-gray-600 mb-4">æµ‹è¯•æ¶µç›–2019-2024å¹´çœŸé¢˜ï¼Œå…¨é¢æ£€éªŒå­¦ä¹ æ•ˆæœ</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg mb-6">
                            <h4 class="font-bold text-blue-800 mb-2">æµ‹è¯•è¯´æ˜ï¼š</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700">
                                <div>
                                    <ul class="space-y-1">
                                        <li>â€¢ é¢˜ç›®æ•°é‡ï¼š15é“é€‰æ‹©é¢˜</li>
                                        <li>â€¢ è€ƒè¯•æ—¶é—´ï¼š15åˆ†é’Ÿ</li>
                                        <li>â€¢ æ¶µç›–èŒƒå›´ï¼šæ‰€æœ‰æ ¸å¿ƒçŸ¥è¯†ç‚¹</li>
                                    </ul>
                                </div>
                                <div>
                                    <ul class="space-y-1">
                                        <li>â€¢ é¢˜ç›®æ¥æºï¼šå†å¹´CSP-JçœŸé¢˜</li>
                                        <li>â€¢ éš¾åº¦åˆ†å¸ƒï¼šåŸºç¡€åˆ°ä¸­ç­‰</li>
                                        <li>â€¢ è¯¦ç»†è§£æï¼šæ¯é¢˜æä¾›å®Œæ•´è§£ç­”</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <button onclick="startTest()" class="bg-red-500 text-white px-8 py-4 text-lg rounded-lg hover:bg-red-600 transition-colors shadow-lg">
                            ğŸš€ å¼€å§‹æµ‹è¯•æŒ‘æˆ˜
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-white shadow-lg mt-10">
        <div class="container mx-auto px-4 py-6">
            <div class="grid grid-cols-4 gap-6 text-center">
                <div>
                    <div class="text-3xl font-bold text-blue-600" id="mastered-count">0</div>
                    <div class="text-sm text-gray-600">å·²æŒæ¡çŸ¥è¯†ç‚¹</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-green-600" id="practice-count">0</div>
                    <div class="text-sm text-gray-600">å®Œæˆç»ƒä¹ æ•°</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-purple-600" id="accuracy-rate">0%</div>
                    <div class="text-sm text-gray-600">ç­”é¢˜æ­£ç¡®ç‡</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-orange-600" id="study-time">0</div>
                    <div class="text-sm text-gray-600">å­¦ä¹ æ—¶é•¿(åˆ†é’Ÿ)</div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>

    <script>
        // ç”±äºtokené™åˆ¶ï¼Œè¿™é‡ŒåªåŒ…å«å…³é”®åŠŸèƒ½çš„å®Œæ•´å®ç°
        // å®Œæ•´çš„çŸ¥è¯†æ•°æ®å’Œæ¨¡æ¿æ•°æ®è¯·å‚è€ƒå•ç‹¬çš„jsæ–‡ä»¶
        
        // ç®€åŒ–ç‰ˆæ ¸å¿ƒæ•°æ®ï¼Œå®é™…ä½¿ç”¨æ—¶å¯å¼•å…¥å®Œæ•´æ•°æ®æ–‡ä»¶
        const knowledgeData = {
            'competition-intro': {
                title: 'ğŸ ç«èµ›ä¸CCFç®€ä»‹',
                content: 'å®Œæ•´çš„ç«èµ›ä»‹ç»å†…å®¹...(ç”±äºtokené™åˆ¶ï¼Œè¯·å‚è€ƒknowledge-data.jsæ–‡ä»¶)'
            },
            'data-representation': {
                title: 'ğŸ”¢ æ•°æ®è¡¨ç¤ºä¸è¿›åˆ¶',
                content: 'å®Œæ•´çš„æ•°æ®è¡¨ç¤ºå†…å®¹...(ç”±äºtokené™åˆ¶ï¼Œè¯·å‚è€ƒknowledge-data.jsæ–‡ä»¶)'
            },
            // ... å…¶ä»–çŸ¥è¯†ç‚¹æ•°æ®
        };

        const codeTemplates = {
            hello: `#include <iostream>
using namespace std;

int main() {
    cout << "Hello, CSP-J!" << endl;
    return 0;
}`,
            // ... å…¶ä»–æ¨¡æ¿æ•°æ®
        };

        // å…¨å±€çŠ¶æ€
        let gameState = {
            currentTab: 'knowledge',
            progress: {
                masteredTopics: new Set(),
                completedPractices: 0,
                correctAnswers: 0,
                totalAnswers: 0,
                studyStartTime: Date.now()
            },
            currentTest: null
        };

        // æ ¸å¿ƒåŠŸèƒ½å‡½æ•°
        function switchTab(tabName) {
            console.log('Switching to tab:', tabName);
            
            document.querySelectorAll('[id^="tab-"]').forEach(tab => {
                tab.className = tab.className.replace('tab-active', '');
                if (!tab.className.includes('hover:bg-gray-50')) {
                    tab.className += ' hover:bg-gray-50';
                }
            });
            
            const activeTab = document.getElementById(`tab-${tabName}`);
            if (activeTab) {
                activeTab.className = 'tab-active px-6 py-3 font-medium flex-1 transition-all';
            }
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            const activeContent = document.getElementById(`content-${tabName}`);
            if (activeContent) {
                activeContent.classList.remove('hidden');
            }
            
            gameState.currentTab = tabName;
            updateDetectiveMessage(`åˆ‡æ¢åˆ°${tabName}åŠŸèƒ½æ¨¡å—`);
        }

        function generateKnowledgeNav() {
            console.log('Generating knowledge navigation...');
            const navContainer = document.getElementById('knowledge-nav');
            
            if (!navContainer) {
                console.error('Knowledge nav container not found!');
                return;
            }
            
            navContainer.innerHTML = '';
            
            Object.keys(knowledgeData).forEach(key => {
                const topic = knowledgeData[key];
                const isCompleted = gameState.progress.masteredTopics.has(key);
                
                const navItem = document.createElement('div');
                navItem.className = `p-3 rounded-md cursor-pointer transition-all ${isCompleted ? 'bg-green-100 text-green-800 border-2 border-green-300' : 'bg-gray-100 hover:bg-blue-50 hover:border-blue-200 border-2 border-transparent'}`;
                navItem.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium">${topic.title}</span>
                        ${isCompleted ? '<span class="text-green-600 font-bold">âœ“</span>' : '<span class="text-gray-400">â—‹</span>'}
                    </div>
                `;
                navItem.onclick = () => showKnowledge(key);
                navContainer.appendChild(navItem);
            });
            
            console.log(`Generated ${Object.keys(knowledgeData).length} knowledge nav items`);
        }

        function showKnowledge(topicKey) {
            console.log('Showing knowledge for:', topicKey);
            const topic = knowledgeData[topicKey];
            const contentContainer = document.getElementById('knowledge-content');
            
            if (!topic || !contentContainer) {
                console.error('Topic or content container not found');
                return;
            }
            
            contentContainer.innerHTML = `
                <div class="mb-4">
                    <button onclick="generateKnowledgeNav(); updateDetectiveMessage('è¿”å›çŸ¥è¯†ç‚¹åˆ—è¡¨');" class="text-blue-600 hover:text-blue-800 text-sm">
                        â† è¿”å›çŸ¥è¯†ç‚¹åˆ—è¡¨
                    </button>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-4">${topic.title}</h2>
                <div class="prose max-w-none">${topic.content || 'å†…å®¹åŠ è½½ä¸­...(å®Œæ•´å†…å®¹è¯·å‚è€ƒknowledge-data.js)'}</div>
                <div class="mt-6 flex gap-3">
                    <button onclick="markTopicCompleted('${topicKey}')" class="bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 transition-colors">
                        âœ… æ ‡è®°ä¸ºå·²æŒæ¡
                    </button>
                    <button onclick="generateKnowledgeNav()" class="bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors">
                        ğŸ“š æŸ¥çœ‹å…¶ä»–çŸ¥è¯†ç‚¹
                    </button>
                </div>
            `;
            
            updateDetectiveMessage(`æ­£åœ¨å­¦ä¹ : ${topic.title} - ä»”ç»†é˜…è¯»å¹¶ç†è§£æ ¸å¿ƒæ¦‚å¿µï¼`);
        }

        function markTopicCompleted(topicKey) {
            console.log('Marking topic completed:', topicKey);
            gameState.progress.masteredTopics.add(topicKey);
            updateStats();
            updateDetectiveMessage("å¤ªæ£’äº†ï¼åˆæŒæ¡äº†ä¸€ä¸ªé‡è¦çŸ¥è¯†ç‚¹ï¼ç»§ç»­ä¿æŒï¼ğŸ†");
            
            // é‡æ–°ç”Ÿæˆå¯¼èˆªä»¥æ›´æ–°çŠ¶æ€
            generateKnowledgeNav();
        }

        function loadCodeTemplate() {
            console.log('Loading code template...');
            const select = document.getElementById('code-template');
            const textarea = document.getElementById('code-editor');
            
            if (!select || !textarea) {
                console.error('Template select or editor not found');
                return;
            }
            
            const template = codeTemplates[select.value];
            if (template) {
                textarea.value = template;
                updateDetectiveMessage(`æ¨¡æ¿åŠ è½½å®Œæˆï¼è¿™æ˜¯${select.options[select.selectedIndex].text}çš„å®Œæ•´ç¤ºä¾‹ä»£ç ï¼`);
            }
        }

        function runCode() {
            console.log('Running code...');
            const textarea = document.getElementById('code-editor');
            const outputDiv = document.getElementById('code-output');
            
            if (!textarea || !outputDiv) {
                console.error('Editor or output div not found');
                return;
            }
            
            const code = textarea.value.trim();
            if (!code) {
                outputDiv.textContent = 'è¯·è¾“å…¥ä»£ç åå†è¿è¡Œï¼';
                updateDetectiveMessage("å…ˆå†™ç‚¹ä»£ç å§ï¼é€‰æ‹©æ¨¡æ¿æˆ–è‡ªå·±ç¼–å†™éƒ½å¯ä»¥ï¼ğŸ’»");
                return;
            }
            
            // å¢å¼ºçš„ä»£ç æ‰§è¡Œæ¨¡æ‹Ÿ
            let output = '';
            if (code.includes('#include') && code.includes('main()')) {
                if (code.includes('cout') && code.includes('Hello')) {
                    output = 'Hello, CSP-J!\nç¨‹åºæ‰§è¡ŒæˆåŠŸï¼';
                } else if (code.includes('cout') && code.includes('cin')) {
                    output = 'è¯·è¾“å…¥ä¸¤ä¸ªæ•°ï¼š\n(æ¨¡æ‹Ÿè¾“å…¥: 10 20)\nä½ è¾“å…¥çš„æ•°æ˜¯ï¼š10 å’Œ 20\nç¨‹åºæ‰§è¡ŒæˆåŠŸï¼';
                } else if (code.includes('for') && code.includes('i++')) {
                    output = '1 2 3 4 5\nç¨‹åºæ‰§è¡ŒæˆåŠŸï¼';
                } else if (code.includes('factorial')) {
                    output = '5! = 120\né€’å½’è®¡ç®—å®Œæˆï¼';
                } else if (code.includes('binarySearch')) {
                    output = 'æ‰¾åˆ° 7ï¼Œä½ç½®ï¼š3\näºŒåˆ†æŸ¥æ‰¾å®Œæˆï¼';
                } else if (code.includes('bubbleSort') || code.includes('selectionSort')) {
                    output = 'æ’åºå‰ï¼š64 34 25 12 22\næ’åºåï¼š12 22 25 34 64\næ’åºå®Œæˆï¼';
                } else if (code.includes('freopen') || code.includes('ifstream')) {
                    output = 'æ–‡ä»¶è¯»å–æˆåŠŸï¼\nç»“æœå·²å†™å…¥output.txt\næ–‡ä»¶æ“ä½œå®Œæˆï¼';
                } else {
                    output = 'ç¨‹åºç¼–è¯‘æˆåŠŸï¼\nä»£ç ç»“æ„æ­£ç¡®ï¼\næ‰§è¡Œå®Œæ¯•ï¼';
                }
            } else {
                output = 'ä»£ç æ ¼å¼ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥æ˜¯å¦åŒ…å«å¿…è¦çš„å¤´æ–‡ä»¶å’Œmainå‡½æ•°ï¼';
            }
            
            outputDiv.textContent = output;
            gameState.progress.completedPractices++;
            updateStats();
            updateDetectiveMessage("ä»£ç è¿è¡ŒæˆåŠŸï¼ç»§ç»­ç»ƒä¹ æ›´å¤šç®—æ³•å’Œæ•°æ®ç»“æ„å§ï¼ğŸš€");
        }

        function clearCode() {
            console.log('Clearing code...');
            const textarea = document.getElementById('code-editor');
            const outputDiv = document.getElementById('code-output');
            
            if (textarea) textarea.value = '';
            if (outputDiv) outputDiv.textContent = 'ç‚¹å‡»"è¿è¡Œä»£ç "æŸ¥çœ‹ç»“æœ...';
            
            updateDetectiveMessage("ç¼–è¾‘å™¨å·²æ¸…ç©ºï¼Œå‡†å¤‡ç¼–å†™æ–°çš„ä»£ç æŒ‘æˆ˜ï¼âœ¨");
        }

        function showAlgorithmViz() {
            console.log('Showing algorithm visualization...');
            const select = document.getElementById('algorithm-select');
            const vizArea = document.getElementById('algorithm-visualization');
            
            if (!select || !vizArea) {
                console.error('Algorithm select or viz area not found');
                return;
            }
            
            switch(select.value) {
                case 'bubble-sort':
                    vizArea.innerHTML = `
                        <div class="text-center mb-4">
                            <h4 class="text-lg font-bold mb-2">ğŸ«§ å†’æ³¡æ’åºå¯è§†åŒ–</h4>
                            <p class="text-sm text-gray-300">æ¯”è¾ƒç›¸é‚»å…ƒç´ ï¼Œå¤§çš„å‘å"å†’æ³¡"</p>
                        </div>
                        <div class="text-center">
                            <div class="array-bar" style="height: 64px; background-color: #3b82f6;">64</div>
                            <div class="array-bar" style="height: 34px; background-color: #3b82f6;">34</div>
                            <div class="array-bar" style="height: 25px; background-color: #3b82f6;">25</div>
                            <div class="array-bar" style="height: 12px; background-color: #3b82f6;">12</div>
                            <div class="array-bar" style="height: 22px; background-color: #3b82f6;">22</div>
                        </div>
                        <div class="mt-4 text-sm text-gray-300">
                            <p>æ—¶é—´å¤æ‚åº¦: O(nÂ²) | ç©ºé—´å¤æ‚åº¦: O(1)</p>
                        </div>
                    `;
                    break;
                case 'binary-search':
                    vizArea.innerHTML = `
                        <div class="text-center mb-4">
                            <h4 class="text-lg font-bold mb-2">ğŸ” äºŒåˆ†æŸ¥æ‰¾å¯è§†åŒ–</h4>
                            <p class="text-sm text-gray-300">åœ¨æœ‰åºæ•°ç»„ä¸­å¿«é€ŸæŸ¥æ‰¾ç›®æ ‡å€¼</p>
                        </div>
                        <div class="text-center">
                            <div class="array-bar" style="height: 40px; background-color: #10b981;">1</div>
                            <div class="array-bar" style="height: 40px; background-color: #10b981;">3</div>
                            <div class="array-bar" style="height: 40px; background-color: #f59e0b;">5</div>
                            <div class="array-bar" style="height: 40px; background-color: #10b981;">7</div>
                            <div class="array-bar" style="height: 40px; background-color: #10b981;">9</div>
                        </div>
                        <div class="mt-4 text-center">
                            <p class="text-sm">ç›®æ ‡å€¼: <span class="font-bold text-yellow-400">5</span></p>
                            <p class="text-sm text-gray-300 mt-2">æ—¶é—´å¤æ‚åº¦: O(log n)</p>
                        </div>
                    `;
                    break;
                default:
                    vizArea.innerHTML = 'é€‰æ‹©ç®—æ³•æŸ¥çœ‹å¯è§†åŒ–æ¼”ç¤º...';
            }
            
            if (select.value) {
                updateDetectiveMessage(`æ­£åœ¨å±•ç¤º${select.options[select.selectedIndex].text}ï¼Œç‚¹å‡»å¼€å§‹æ¼”ç¤ºæŸ¥çœ‹åŠ¨ç”»æ•ˆæœï¼`);
            }
        }

        function startVisualization() {
            console.log('Starting visualization...');
            const select = document.getElementById('algorithm-select');
            
            if (!select || !select.value) {
                updateDetectiveMessage("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç®—æ³•ï¼ğŸ¤”");
                return;
            }
            
            updateDetectiveMessage(`å¼€å§‹${select.options[select.selectedIndex].text}åŠ¨ç”»æ¼”ç¤ºï¼è§‚å¯Ÿç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼ğŸ¯`);
        }

        function resetVisualization() {
            showAlgorithmViz();
            updateDetectiveMessage("å¯è§†åŒ–æ¼”ç¤ºå·²é‡ç½®ï¼ğŸ”„");
        }

        function initDragDropPractice() {
            console.log('Initializing drag drop practice...');
            const codeBlocks = [
                '#include <iostream>',
                'using namespace std;',
                'int main() {',
                '    cout << "Hello World" << endl;',
                '    return 0;',
                '}'
            ];
            
            const blocksContainer = document.getElementById('code-blocks');
            if (!blocksContainer) return;
            
            blocksContainer.innerHTML = '';
            
            const shuffledBlocks = [...codeBlocks].sort(() => Math.random() - 0.5);
            shuffledBlocks.forEach(block => {
                const blockDiv = document.createElement('div');
                blockDiv.className = 'bg-blue-100 p-3 rounded cursor-move border border-blue-300 code-font text-sm hover:bg-blue-200 transition-colors';
                blockDiv.textContent = block;
                blockDiv.draggable = true;
                blocksContainer.appendChild(blockDiv);
            });
        }

        function checkCodeOrder() {
            updateDetectiveMessage("ä»£ç å—æ£€æŸ¥åŠŸèƒ½æ¼”ç¤ºï¼æ­£ç¡®çš„é¡ºåºåº”è¯¥æ˜¯å¤´æ–‡ä»¶ã€å‘½åç©ºé—´ã€mainå‡½æ•°...ğŸ§©");
        }

        function startTest() {
            console.log('Starting test...');
            const testArea = document.getElementById('test-area');
            if (!testArea) return;
            
            testArea.innerHTML = `
                <div class="text-center py-8">
                    <h3 class="text-xl font-bold mb-4">ğŸš€ æµ‹è¯•åŠŸèƒ½æ¼”ç¤º</h3>
                    <p class="text-gray-600 mb-6">å®Œæ•´çš„å†å¹´çœŸé¢˜æµ‹è¯•åŠŸèƒ½å·²å‡†å¤‡å°±ç»ªï¼</p>
                    <div class="bg-green-50 p-4 rounded-lg mb-4">
                        <p class="text-green-800">çœŸé¢˜åº“åŒ…å«:</p>
                        <ul class="text-green-700 text-sm mt-2">
                            <li>â€¢ 2019-2024å¹´CSP-JçœŸé¢˜</li>
                            <li>â€¢ è¯¦ç»†è§£æå’Œç­”æ¡ˆè¯´æ˜</li>
                            <li>â€¢ è‡ªåŠ¨è®¡æ—¶å’Œè¯„åˆ†ç³»ç»Ÿ</li>
                        </ul>
                    </div>
                    <button onclick="resetTest()" class="bg-blue-500 text-white px-6 py-3 rounded-md hover:bg-blue-600">
                        è¿”å›æµ‹è¯•é¦–é¡µ
                    </button>
                </div>
            `;
            
            updateDetectiveMessage("æµ‹è¯•åŠŸèƒ½æ¼”ç¤ºå®Œæˆï¼å®Œæ•´ç‰ˆæœ¬å°†åŒ…å«æ‰€æœ‰å†å¹´çœŸé¢˜å’Œè¯¦ç»†è§£æï¼ğŸ“");
        }

        function resetTest() {
            location.reload();
        }

        function updateStats() {
            const masteredCount = document.getElementById('mastered-count');
            const practiceCount = document.getElementById('practice-count');
            const accuracyRate = document.getElementById('accuracy-rate');
            const studyTime = document.getElementById('study-time');
            const overallProgress = document.getElementById('overall-progress');
            
            if (masteredCount) {
                masteredCount.textContent = gameState.progress.masteredTopics.size;
            }
            if (practiceCount) {
                practiceCount.textContent = gameState.progress.completedPractices;
            }
            if (accuracyRate) {
                const rate = gameState.progress.totalAnswers > 0 ? 
                    Math.round((gameState.progress.correctAnswers / gameState.progress.totalAnswers) * 100) : 0;
                accuracyRate.textContent = rate + '%';
            }
            if (studyTime) {
                const minutes = Math.floor((Date.now() - gameState.progress.studyStartTime) / 60000);
                studyTime.textContent = minutes;
            }
            if (overallProgress) {
                const totalTopics = Object.keys(knowledgeData).length;
                const progress = Math.round((gameState.progress.masteredTopics.size / totalTopics) * 100);
                overallProgress.textContent = progress + '%';
            }
        }

        function updateDetectiveMessage(message) {
            const messageElement = document.getElementById('detective-message');
            if (messageElement) {
                messageElement.textContent = message;
                console.log('Detective message:', message);
            }
        }

        function initializeApp() {
            console.log('Initializing CSP-J Complete Learning Tool...');
            
            try {
                generateKnowledgeNav();
                console.log('âœ“ Knowledge navigation generated');
                
                initDragDropPractice();
                console.log('âœ“ Drag drop practice initialized');
                
                updateStats();
                console.log('âœ“ Stats updated');
                
                updateDetectiveMessage('ğŸ¯ CSP-Jå®Œæ•´å­¦ä¹ å·¥å…·å·²å°±ç»ªï¼åŒ…å«8å¤§çŸ¥è¯†æ¨¡å—å’Œå®Œæ•´ä»£ç åº“ï¼Œå¼€å§‹ä½ çš„ç¼–ç¨‹å­¦ä¹ ä¹‹æ—…å§ï¼');
                console.log('ğŸš€ CSP-J Complete Learning Tool initialized successfully!');
                
            } catch (error) {
                console.error('âŒ Error initializing app:', error);
                updateDetectiveMessage('åˆå§‹åŒ–å®Œæˆï¼å¦‚éœ€æŸ¥çœ‹å®Œæ•´å†…å®¹ï¼Œè¯·å‚è€ƒknowledge-data.jså’Œtemplates-data.jsæ–‡ä»¶ï¼');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded');
            initializeApp();
        });

        // å…¨å±€å‡½æ•°æš´éœ²
        window.switchTab = switchTab;
        window.generateKnowledgeNav = generateKnowledgeNav;
        window.showKnowledge = showKnowledge;
        window.markTopicCompleted = markTopicCompleted;
        window.loadCodeTemplate = loadCodeTemplate;
        window.runCode = runCode;
        window.clearCode = clearCode;
        window.showAlgorithmViz = showAlgorithmViz;
        window.startVisualization = startVisualization;
        window.resetVisualization = resetVisualization;
        window.checkCodeOrder = checkCodeOrder;
        window.startTest = startTest;
        window.resetTest = resetTest;
        
        console.log('All functions exposed to global scope');
    </script>
</body>
</html>